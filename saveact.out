INFO:numexpr.utils:Note: NumExpr detected 64 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
INFO:numexpr.utils:NumExpr defaulting to 8 threads.
/mnt/home/rzhang/venvs/aion/lib/python3.10/site-packages/albumentations/__init__.py:28: UserWarning: A new version of Albumentations is available: '2.0.6' (you have '2.0.5'). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.
  check_for_updates()
INFO:datasets:PyTorch version 2.4.0+cu124 available.
INFO:datasets:TensorFlow version 2.16.1 available.
INFO:datasets:JAX version 0.4.26 available.

=== Loading Model ===
Loading weights from local directory
Model loaded from pretrained weights
Model moved to CUDA and set to eval mode
Model architecture:
AION(
  (encoder_embeddings): ModuleDict(
    (catalog): SequenceEncoderEmbedding(
      (token_emb): Embedding(3468, 768, padding_idx=0)
    )
    (tok_a_g): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_a_i): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_a_r): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_a_y): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_a_z): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_dec): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_ebv): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_bp_gaia): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_g): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_g_gaia): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_i): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_r): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_rp_gaia): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_w1): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_w2): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_w3): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_w4): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_flux_z): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_image): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(4375, 768)
    )
    (tok_image_hsc): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(4375, 768)
    )
    (tok_mag_g): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_mag_i): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_mag_r): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_mag_y): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_mag_z): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_parallax): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_ra): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_segmap): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1000, 768)
    )
    (tok_shape11): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_shape12): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_shape22): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_shape_e1): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_shape_e2): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_shape_r): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_spectrum_desi): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_spectrum_sdss): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_xp_bp): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_xp_rp): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1024, 768)
    )
    (tok_z): ImageTokenEncoderEmbedding(
      (token_emb): Embedding(1025, 768)
    )
  )
  (decoder_embeddings): ModuleDict(
    (catalog): SequenceDecoderEmbedding(
      (token_emb): Embedding(3468, 768, padding_idx=0)
      (to_logits): Linear(in_features=768, out_features=3468, bias=False)
    )
    (tok_a_g): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_a_i): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_a_r): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_a_y): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_a_z): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_dec): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_ebv): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_bp_gaia): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_g): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_g_gaia): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_i): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_r): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_rp_gaia): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_w1): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_w2): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_w3): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_w4): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_flux_z): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_image): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(4375, 768)
      (to_logits): Linear(in_features=768, out_features=4375, bias=False)
    )
    (tok_image_hsc): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(4375, 768)
      (to_logits): Linear(in_features=768, out_features=4375, bias=False)
    )
    (tok_mag_g): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_mag_i): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_mag_r): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_mag_y): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_mag_z): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_parallax): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_ra): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_segmap): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1000, 768)
      (to_logits): Linear(in_features=768, out_features=1000, bias=False)
    )
    (tok_shape11): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_shape12): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_shape22): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_shape_e1): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_shape_e2): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_shape_r): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_spectrum_desi): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_spectrum_sdss): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_xp_bp): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_xp_rp): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1024, 768)
      (to_logits): Linear(in_features=768, out_features=1024, bias=False)
    )
    (tok_z): ImageTokenDecoderEmbedding(
      (token_emb): Embedding(1025, 768)
      (to_logits): Linear(in_features=768, out_features=1025, bias=False)
    )
  )
  (encoder): ModuleList(
    (0-11): 12 x Block(
      (norm1): LayerNorm()
      (attn): NormAttention(
        (qkv): Linear(in_features=768, out_features=2304, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=False)
        (proj_drop): Dropout(p=0.0, inplace=False)
        (q_norm): LayerNorm()
        (k_norm): LayerNorm()
      )
      (drop_path): Identity()
      (norm2): LayerNorm()
      (mlp): GatedMlp(
        (fc1): Linear(in_features=768, out_features=2048, bias=False)
        (act): SiLU()
        (fc2): Linear(in_features=2048, out_features=768, bias=False)
        (fc3): Linear(in_features=768, out_features=2048, bias=False)
      )
    )
  )
  (encoder_norm): LayerNorm()
  (decoder_proj_context): Linear(in_features=768, out_features=768, bias=True)
  (decoder): ModuleList(
    (0-11): 12 x DecoderBlock(
      (norm1): LayerNorm()
      (self_attn): NormAttention(
        (qkv): Linear(in_features=768, out_features=2304, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=False)
        (proj_drop): Dropout(p=0.0, inplace=False)
        (q_norm): LayerNorm()
        (k_norm): LayerNorm()
      )
      (cross_attn): NormCrossAttention(
        (q): Linear(in_features=768, out_features=768, bias=False)
        (kv): Linear(in_features=768, out_features=1536, bias=False)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=False)
        (proj_drop): Dropout(p=0.0, inplace=False)
        (q_norm): LayerNorm()
        (k_norm): LayerNorm()
      )
      (query_norm): LayerNorm()
      (context_norm): LayerNorm()
      (drop_path): Identity()
      (norm2): LayerNorm()
      (mlp): GatedMlp(
        (fc1): Linear(in_features=768, out_features=2048, bias=False)
        (act): SiLU()
        (fc2): Linear(in_features=2048, out_features=768, bias=False)
        (fc3): Linear(in_features=768, out_features=2048, bias=False)
      )
    )
  )
  (decoder_norm): LayerNorm()
)

=== Setting Up Data ===
Data config path: 4Mclone/cfgs/default/mmoma/data/mmu/rusty_legacysurvey_desi_sdss_hsc.yaml
Text tokenizer path: 4Mclone/fourm/utils/tokenizer/trained/text_tokenizer_4m_wordpiece_30k.json
Batch size: 128
Epoch size: 5000
Loading data config from: 4Mclone/cfgs/default/mmoma/data/mmu/rusty_legacysurvey_desi_sdss_hsc.yaml
Setting up dataset legacysurvey / train
Loading alphas config from: 4Mclone/cfgs/default/mmoma/data/mmu/beta_configs.yaml
Setting up dataset hscwide / train
Loading alphas config from: 4Mclone/cfgs/default/mmoma/data/mmu/beta_configs.yaml
Setting up dataset hscwide_legacysurvey / train
Loading alphas config from: 4Mclone/cfgs/default/mmoma/data/mmu/beta_configs.yaml
Setting up dataset sdss / train
Loading alphas config from: 4Mclone/cfgs/default/mmoma/data/mmu/beta_configs.yaml
Setting up dataset desi / train
Loading alphas config from: 4Mclone/cfgs/default/mmoma/data/mmu/beta_configs.yaml
Setting up dataset desi_sdss / train
Loading alphas config from: 4Mclone/cfgs/default/mmoma/data/mmu/beta_configs.yaml
Setting up dataset sdss_legacysurvey / train
Loading alphas config from: 4Mclone/cfgs/default/mmoma/data/mmu/beta_configs.yaml
Setting up dataset desi_legacysurvey / train
Loading alphas config from: 4Mclone/cfgs/default/mmoma/data/mmu/beta_configs.yaml
Setting up dataset sdss_hscwide / train
Loading alphas config from: 4Mclone/cfgs/default/mmoma/data/mmu/beta_configs.yaml

=== Modality Information ===
Available modalities: ['catalog', 'tok_a_g', 'tok_a_i', 'tok_a_r', 'tok_a_y', 'tok_a_z', 'tok_ebv', 'tok_flux_g', 'tok_flux_i', 'tok_flux_r', 'tok_flux_w1', 'tok_flux_w2', 'tok_flux_w3', 'tok_flux_w4', 'tok_flux_z', 'tok_image', 'tok_image_hsc', 'tok_mag_g', 'tok_mag_i', 'tok_mag_r', 'tok_mag_y', 'tok_mag_z', 'tok_segmap', 'tok_shape11', 'tok_shape12', 'tok_shape22', 'tok_shape_e1', 'tok_shape_e2', 'tok_shape_r', 'tok_spectrum_desi', 'tok_spectrum_sdss', 'tok_z']

Modality: catalog
  Available keys: ['vocab_size', 'vocab_offset', 'codec_pad_id', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  vocab_size: 3468
  vocab_offset: 204
  codec_pad_id: 9999
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.SequenceEncoderEmbedding'>, vocab_size=3468, max_length=50, padding_idx=0)
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.SequenceDecoderEmbedding'>, vocab_size=3468, max_length=50, padding_idx=0)
  min_tokens: 0
  max_tokens: 50
  type: seq_token
  id: 12119
  pretokenized: True

Modality: tok_a_g
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 17883
  pretokenized: True

Modality: tok_a_i
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 25778
  pretokenized: True

Modality: tok_a_r
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 1702
  pretokenized: True

Modality: tok_a_y
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 21195
  pretokenized: True

Modality: tok_a_z
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 21929
  pretokenized: True

Modality: tok_ebv
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 20985
  pretokenized: True

Modality: tok_flux_g
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 14685
  pretokenized: True

Modality: tok_flux_i
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 7805
  pretokenized: True

Modality: tok_flux_r
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 27058
  pretokenized: True

Modality: tok_flux_w1
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 23337
  pretokenized: True

Modality: tok_flux_w2
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 12933
  pretokenized: True

Modality: tok_flux_w3
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 23208
  pretokenized: True

Modality: tok_flux_w4
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 14980
  pretokenized: True

Modality: tok_flux_z
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 9109
  pretokenized: True

Modality: tok_image
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 96
  Patch size: 4
  vocab_size: 4375
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=4375, patch_size=4, image_size=(96, 96))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=4375, patch_size=4, image_size=(96, 96))
  min_tokens: 0
  max_tokens: 576
  type: img
  id: 18665
  pretokenized: True

Modality: tok_image_hsc
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 96
  Patch size: 4
  vocab_size: 4375
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=4375, patch_size=4, image_size=(96, 96))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=4375, patch_size=4, image_size=(96, 96))
  min_tokens: 0
  max_tokens: 576
  type: img
  id: 13799
  pretokenized: True

Modality: tok_mag_g
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 28104
  pretokenized: True

Modality: tok_mag_i
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 32529
  pretokenized: True

Modality: tok_mag_r
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 25658
  pretokenized: True

Modality: tok_mag_y
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 6731
  pretokenized: True

Modality: tok_mag_z
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 23041
  pretokenized: True

Modality: tok_segmap
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 96
  Patch size: 8
  vocab_size: 1000
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1000, patch_size=8, image_size=(96, 96))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1000, patch_size=8, image_size=(96, 96))
  min_tokens: 0
  max_tokens: 144
  type: img
  id: 11864
  pretokenized: True

Modality: tok_shape11
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 19508
  pretokenized: True

Modality: tok_shape12
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 31216
  pretokenized: True

Modality: tok_shape22
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 24183
  pretokenized: True

Modality: tok_shape_e1
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 14025
  pretokenized: True

Modality: tok_shape_e2
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 16284
  pretokenized: True

Modality: tok_shape_r
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 19813
  pretokenized: True

Modality: tok_spectrum_desi
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 273
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(273, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(273, 1))
  min_tokens: 0
  max_tokens: 273
  type: img
  id: 289
  pretokenized: True

Modality: tok_spectrum_sdss
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 273
  Patch size: 1
  vocab_size: 1024
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(273, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1024, patch_size=1, image_size=(273, 1))
  min_tokens: 0
  max_tokens: 273
  type: img
  id: 2489
  pretokenized: True

Modality: tok_z
  Available keys: ['input_size', 'patch_size', 'vocab_size', 'encoder_embedding', 'decoder_embedding', 'min_tokens', 'max_tokens', 'type', 'id', 'pretokenized']
  Input size: 1
  Patch size: 1
  vocab_size: 1025
  encoder_embedding: functools.partial(<class 'fourm.models.encoder_embeddings.ImageTokenEncoderEmbedding'>, vocab_size=1025, patch_size=1, image_size=(1, 1))
  decoder_embedding: functools.partial(<class 'fourm.models.decoder_embeddings.ImageTokenDecoderEmbedding'>, vocab_size=1025, patch_size=1, image_size=(1, 1))
  min_tokens: 0
  max_tokens: 1
  type: img
  id: 9755
  pretokenized: True

=== Data Loader Information ===
Number of training steps per epoch: 39

=== Sample Batch Structure ===
Batch keys: ['catalog', 'tok_a_g', 'tok_a_i', 'tok_a_r', 'tok_a_y', 'tok_a_z', 'tok_ebv', 'tok_flux_g', 'tok_flux_i', 'tok_flux_r', 'tok_flux_w1', 'tok_flux_w2', 'tok_flux_w3', 'tok_flux_w4', 'tok_flux_z', 'tok_image', 'tok_image_hsc', 'tok_mag_g', 'tok_mag_i', 'tok_mag_r', 'tok_mag_y', 'tok_mag_z', 'tok_segmap', 'tok_shape11', 'tok_shape12', 'tok_shape22', 'tok_shape_e1', 'tok_shape_e2', 'tok_shape_r', 'tok_spectrum_desi', 'tok_spectrum_sdss', 'tok_z']

Modality: catalog
  tensor shape: torch.Size([128, 102])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 3454
  tensor mean value: 49.53492736816406
  input_mask shape: torch.Size([128, 102])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 102])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 102])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_a_g
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 383
  tensor mean value: 11.2890625
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_a_i
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 381
  tensor mean value: 11.203125
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_a_r
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 383
  tensor mean value: 11.2890625
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_a_y
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 384
  tensor mean value: 11.3125
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_a_z
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 383
  tensor mean value: 11.265625
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_ebv
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 609
  tensor mean value: 508.453125
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_flux_g
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 1019
  tensor mean value: 482.46875
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_flux_i
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 1018
  tensor mean value: 456.2265625
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_flux_r
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 1018
  tensor mean value: 467.96875
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_flux_w1
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 1019
  tensor mean value: 407.59375
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_flux_w2
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 1019
  tensor mean value: 402.515625
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_flux_w3
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 1022
  tensor mean value: 401.890625
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_flux_w4
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 964
  tensor mean value: 469.1796875
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_flux_z
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 1018
  tensor mean value: 437.59375
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_image
  tensor shape: torch.Size([128, 576])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 4355
  tensor mean value: 3202.27294921875
  input_mask shape: torch.Size([128, 576])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 576])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 576])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_image_hsc
  tensor shape: torch.Size([128, 576])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 4352
  tensor mean value: 111.44561004638672
  input_mask shape: torch.Size([128, 576])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 576])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 576])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_mag_g
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 668
  tensor mean value: 10.7109375
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_mag_i
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 488
  tensor mean value: 9.6953125
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_mag_r
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 494
  tensor mean value: 9.296875
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_mag_y
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 484
  tensor mean value: 10.0
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_mag_z
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 483
  tensor mean value: 9.8984375
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_segmap
  tensor shape: torch.Size([128, 144])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 995
  tensor mean value: 124.2001953125
  input_mask shape: torch.Size([128, 144])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 144])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 144])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_shape11
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 407
  tensor mean value: 9.765625
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_shape12
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 471
  tensor mean value: 11.4453125
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_shape22
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 742
  tensor mean value: 14.7890625
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_shape_e1
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 1011
  tensor mean value: 340.796875
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_shape_e2
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 979
  tensor mean value: 364.8984375
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_shape_r
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int64
  tensor device: cpu
  tensor min value: 0
  tensor max value: 987
  tensor mean value: 440.609375
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_spectrum_desi
  tensor shape: torch.Size([128, 273])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 1023
  tensor mean value: 12.505064964294434
  input_mask shape: torch.Size([128, 273])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 273])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 273])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_spectrum_sdss
  tensor shape: torch.Size([128, 273])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 1023
  tensor mean value: 35.91446304321289
  input_mask shape: torch.Size([128, 273])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 273])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 273])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

Modality: tok_z
  tensor shape: torch.Size([128, 1])
  tensor dtype: torch.int32
  tensor device: cpu
  tensor min value: 0
  tensor max value: 307
  tensor mean value: 11.6015625
  input_mask shape: torch.Size([128, 1])
  input_mask dtype: torch.bool
  input_mask device: cpu
  target_mask shape: torch.Size([128, 1])
  target_mask dtype: torch.bool
  target_mask device: cpu
  decoder_attention_mask shape: torch.Size([128, 1])
  decoder_attention_mask dtype: torch.int32
  decoder_attention_mask device: cpu

=== Starting Main Collection Process ===
Will collect activations from all available examples in the data loader

=== Starting Activation Collection ===
Registered hook on decoder block 8

Processing batch 1
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([183, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.645155429840088
  Max value: 11.402703285217285
  Mean value: 0.9998881816864014

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.986433029174805
  Max value: 6.72191047668457
  Mean value: -3.717379093170166

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.505163192749023
  Max value: 27.453489303588867
  Mean value: -2.34446382522583

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.919445037841797
  Max value: 7.497852325439453
  Mean value: -4.4306464195251465

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.062471389770508
  Max value: 29.673648834228516
  Mean value: -1.7351802587509155

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.77934455871582
  Max value: 28.733585357666016
  Mean value: -0.9591706991195679

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.934055805206299
  Max value: 6.216838359832764
  Mean value: -0.12555178999900818

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.839521408081055
  Max value: 11.210339546203613
  Mean value: 1.3587110042572021

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.298918724060059
  Max value: 13.498382568359375
  Mean value: 2.0355162620544434

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.994116306304932
  Max value: 11.939209938049316
  Mean value: 2.1354711055755615

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.037306785583496
  Max value: 8.132261276245117
  Mean value: -0.06834571808576584

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.985064506530762
  Max value: 6.753889560699463
  Mean value: -0.8038454651832581

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.132604598999023
  Max value: 27.964750289916992
  Mean value: -0.5059348344802856

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -36.99384689331055
  Max value: 41.59667205810547
  Mean value: 2.8227953910827637

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.766493797302246
  Max value: 13.950942993164062
  Mean value: 1.3137037754058838

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5041, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.209877014160156
  Max value: 15.084859848022461
  Mean value: -9.123294830322266

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([205, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.276941299438477
  Max value: 2.8027231693267822
  Mean value: -10.87597370147705

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.367506980895996
  Max value: 12.392904281616211
  Mean value: 1.6964542865753174

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.191112995147705
  Max value: 19.39027976989746
  Mean value: 3.3570542335510254

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.245388984680176
  Max value: 17.47920036315918
  Mean value: 1.3197697401046753

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.297652244567871
  Max value: 6.065585613250732
  Mean value: -0.9650532603263855

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -0.22800937294960022
  Max value: 19.329870223999023
  Mean value: 7.560185432434082

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1207, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.930233001708984
  Max value: 9.076233863830566
  Mean value: -1.3009430170059204

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.145588874816895
  Max value: 3.747235059738159
  Mean value: -4.775557994842529

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.059567451477051
  Max value: 9.152872085571289
  Mean value: 0.0641447901725769

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.27444839477539
  Max value: 10.698620796203613
  Mean value: -1.4332926273345947

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.661537170410156
  Max value: 19.493492126464844
  Mean value: 2.140230178833008

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.600980758666992
  Max value: 17.508575439453125
  Mean value: 2.261166572570801

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.796040534973145
  Max value: 7.495730876922607
  Mean value: 1.353047490119934

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([50, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.797574520111084
  Max value: 8.259231567382812
  Mean value: 0.09822077304124832

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([110, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.6334686279296875
  Max value: 11.182211875915527
  Mean value: 0.837121307849884

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.493080139160156
  Max value: 0.37639904022216797
  Mean value: -10.243958473205566
Total examples processed: 128

Processing batch 2
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([238, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.541354656219482
  Max value: 11.294137001037598
  Mean value: 1.0227657556533813

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.1989688873291
  Max value: 3.846087694168091
  Mean value: -6.07291316986084

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.198360443115234
  Max value: 5.714543342590332
  Mean value: -3.201657772064209

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.10660171508789
  Max value: 5.8330535888671875
  Mean value: -2.548806667327881

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.94015884399414
  Max value: 5.283326148986816
  Mean value: -4.7662553787231445

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.339933395385742
  Max value: 6.127304553985596
  Mean value: -3.4565606117248535

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.376158714294434
  Max value: 7.108877182006836
  Mean value: -0.14519116282463074

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.370702743530273
  Max value: 10.062788009643555
  Mean value: 1.5892904996871948

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.581814765930176
  Max value: 12.567445755004883
  Mean value: 2.1021175384521484

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.139287948608398
  Max value: 13.77127456665039
  Mean value: 2.1418163776397705

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.568883895874023
  Max value: 10.574041366577148
  Mean value: 0.0353354886174202

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.28862762451172
  Max value: 8.789586067199707
  Mean value: -0.7889205813407898

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.759693145751953
  Max value: 25.903310775756836
  Mean value: 0.1219848245382309

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.759136199951172
  Max value: 53.52394104003906
  Mean value: 2.93772029876709

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.810649871826172
  Max value: 14.304998397827148
  Mean value: 1.5099395513534546

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4642, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.49337387084961
  Max value: 7.080775260925293
  Mean value: -9.15206241607666

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([271, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.430587768554688
  Max value: 1.6756681203842163
  Mean value: -12.074594497680664

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.491865158081055
  Max value: 7.741487979888916
  Mean value: -2.2740821838378906

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.3543429374694824
  Max value: 11.357616424560547
  Mean value: 3.8562753200531006

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.572641372680664
  Max value: -0.5400043725967407
  Mean value: -6.842673301696777

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.7022194862365723
  Max value: 16.29778480529785
  Mean value: 5.919994354248047

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 1.2597241401672363
  Max value: 9.335135459899902
  Mean value: 4.0395073890686035

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1069, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.137125968933105
  Max value: 8.966487884521484
  Mean value: -1.2085810899734497

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.381347417831421
  Max value: 7.10357666015625
  Mean value: 2.4304051399230957

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.8244967460632324
  Max value: 2.575314521789551
  Mean value: -0.2151915729045868

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.848278045654297
  Max value: 8.77490234375
  Mean value: -2.105635166168213

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.373287200927734
  Max value: 13.87006950378418
  Mean value: 2.2669999599456787

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.927144050598145
  Max value: 20.776731491088867
  Mean value: 2.1852495670318604

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.806995391845703
  Max value: 8.307120323181152
  Mean value: 1.3137317895889282

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([92, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.193203926086426
  Max value: 17.152175903320312
  Mean value: 4.78665018081665

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([151, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.01188325881958
  Max value: 12.12304401397705
  Mean value: 0.3421670198440552

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.583293914794922
  Max value: 11.113259315490723
  Mean value: -12.864177703857422
Total examples processed: 256

Processing batch 3
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([207, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.62709379196167
  Max value: 10.117459297180176
  Mean value: 0.997404158115387

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.741151809692383
  Max value: 4.002476215362549
  Mean value: -4.690771102905273

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.91400718688965
  Max value: 5.264183044433594
  Mean value: -4.161882400512695

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.846755981445312
  Max value: 5.010574817657471
  Mean value: -5.2462077140808105

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.307775497436523
  Max value: 4.916504859924316
  Mean value: -3.1261305809020996

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.727766036987305
  Max value: 5.748969078063965
  Mean value: -3.562901258468628

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.945146560668945
  Max value: 5.9731950759887695
  Mean value: -0.1428220123052597

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.640398025512695
  Max value: 9.22956371307373
  Mean value: 1.6972553730010986

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.922956466674805
  Max value: 12.357614517211914
  Mean value: 2.1045777797698975

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.723457336425781
  Max value: 12.866374969482422
  Mean value: 2.0378313064575195

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.11396598815918
  Max value: 13.192195892333984
  Mean value: -0.1204712837934494

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.7675838470459
  Max value: 7.519709587097168
  Mean value: -0.7468072772026062

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -33.84124755859375
  Max value: 30.957313537597656
  Mean value: -0.4580657184123993

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([63, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -33.683692932128906
  Max value: 47.56415939331055
  Mean value: 2.663947582244873

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.704544544219971
  Max value: 13.85989761352539
  Mean value: 1.412273645401001

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5395, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -30.68547821044922
  Max value: 13.140755653381348
  Mean value: -9.33601188659668

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([513, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.714649200439453
  Max value: 1.0694116353988647
  Mean value: -11.132107734680176

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.483180046081543
  Max value: 6.035672664642334
  Mean value: -1.1618953943252563

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.108496189117432
  Max value: 8.10339069366455
  Mean value: -0.01660389080643654

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.55844783782959
  Max value: 12.508186340332031
  Mean value: -1.8203320503234863

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.307397842407227
  Max value: 3.8724160194396973
  Mean value: -2.1598901748657227

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.31458854675293
  Max value: 6.257347106933594
  Mean value: 0.5383607745170593

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([982, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.093439102172852
  Max value: 7.054566860198975
  Mean value: -1.321751594543457

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.147017478942871
  Max value: 4.477700710296631
  Mean value: -4.2144999504089355

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.951842784881592
  Max value: 5.150389194488525
  Mean value: -1.1779345273971558

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.42291259765625
  Max value: 10.460267066955566
  Mean value: -4.505059719085693

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.444374084472656
  Max value: 22.07319450378418
  Mean value: 2.2624125480651855

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.844066619873047
  Max value: 23.202184677124023
  Mean value: 1.7673734426498413

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.718465805053711
  Max value: 7.972668647766113
  Mean value: 1.340619683265686

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([37, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.248128890991211
  Max value: 6.854029655456543
  Mean value: 0.6309487819671631

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([192, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.300179958343506
  Max value: 10.12673568725586
  Mean value: 0.5630297660827637

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.28493881225586
  Max value: -11.585798263549805
  Mean value: -20.428993225097656
Total examples processed: 384

Processing batch 4
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([185, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.900736808776855
  Max value: 12.49876880645752
  Mean value: 0.9131200909614563

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.775564193725586
  Max value: 28.49285316467285
  Mean value: -0.31189560890197754

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.202312469482422
  Max value: 28.887420654296875
  Mean value: -0.8599495887756348

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.616744995117188
  Max value: 22.774673461914062
  Mean value: -1.495976448059082

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.61810874938965
  Max value: 27.153812408447266
  Mean value: -3.694469928741455

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.645225524902344
  Max value: 23.953533172607422
  Mean value: -3.701075553894043

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.114439010620117
  Max value: 6.475002288818359
  Mean value: -0.07978527247905731

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.847583770751953
  Max value: 10.47365665435791
  Mean value: 1.3918410539627075

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.572440147399902
  Max value: 12.449090003967285
  Mean value: 2.008256435394287

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.591407775878906
  Max value: 12.759161949157715
  Mean value: 2.1614465713500977

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([90, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.974510192871094
  Max value: 15.407631874084473
  Mean value: -0.007525862660259008

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.23175811767578
  Max value: 9.998291015625
  Mean value: -0.7670484781265259

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.566604614257812
  Max value: 36.42824172973633
  Mean value: 0.22352154552936554

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.383708953857422
  Max value: 41.24626541137695
  Mean value: 2.803680181503296

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.592788696289062
  Max value: 13.215836524963379
  Mean value: 1.489208459854126

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5266, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.66753578186035
  Max value: 11.475458145141602
  Mean value: -8.801959991455078

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([274, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.894502639770508
  Max value: 4.5367631912231445
  Mean value: -11.497701644897461

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 2.1716318130493164
  Max value: 22.210384368896484
  Mean value: 18.03001594543457

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.052359580993652
  Max value: 20.71528434753418
  Mean value: 3.538695812225342

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.188335418701172
  Max value: 20.764789581298828
  Mean value: 2.458533763885498

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.983664035797119
  Max value: 4.048556804656982
  Mean value: -1.204777717590332

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.797749042510986
  Max value: 14.747040748596191
  Mean value: 3.5320091247558594

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1066, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.07748794555664
  Max value: 7.3089518547058105
  Mean value: -1.2926098108291626

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.493515014648438
  Max value: 9.351958274841309
  Mean value: -1.2725313901901245

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.419976711273193
  Max value: 11.10330581665039
  Mean value: 0.6047008633613586

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.041555404663086
  Max value: 7.885404109954834
  Mean value: 0.16238918900489807

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.15230941772461
  Max value: 22.894454956054688
  Mean value: 1.8030786514282227

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.463016510009766
  Max value: 15.975297927856445
  Mean value: 1.3912692070007324

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([93, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.401147842407227
  Max value: 9.72659683227539
  Mean value: 1.3574872016906738

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([20, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.0806844234466553
  Max value: 11.67546272277832
  Mean value: 2.606966495513916

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([173, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.98670768737793
  Max value: 11.189990997314453
  Mean value: 1.0436863899230957

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.073461532592773
  Max value: 5.472711563110352
  Mean value: -9.130337715148926
Total examples processed: 512

Processing batch 5
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([161, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.304235935211182
  Max value: 10.857577323913574
  Mean value: 0.9892071485519409

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.847606658935547
  Max value: 21.636798858642578
  Mean value: -0.7026705741882324

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.507805824279785
  Max value: 26.28208351135254
  Mean value: 2.950925350189209

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.993148803710938
  Max value: 23.24928092956543
  Mean value: -0.1702514886856079

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.735958099365234
  Max value: 25.249774932861328
  Mean value: -2.143054962158203

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.72701072692871
  Max value: 26.538612365722656
  Mean value: 0.2716061770915985

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.17299222946167
  Max value: 7.940181732177734
  Mean value: -0.0835956558585167

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.568029403686523
  Max value: 11.121538162231445
  Mean value: 1.5421944856643677

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.000755310058594
  Max value: 13.196773529052734
  Mean value: 2.0128941535949707

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.043766021728516
  Max value: 12.010200500488281
  Mean value: 1.915605068206787

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.614381790161133
  Max value: 26.177608489990234
  Mean value: -0.1089312732219696

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.73389434814453
  Max value: 12.60738754272461
  Mean value: -0.7040098905563354

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.514650344848633
  Max value: 48.98594284057617
  Mean value: 0.764475405216217

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.03063201904297
  Max value: 55.091552734375
  Mean value: 3.526890754699707

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.310338020324707
  Max value: 19.04192543029785
  Mean value: 1.4239871501922607

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4898, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.956253051757812
  Max value: 18.284103393554688
  Mean value: -8.971688270568848

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([166, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.749366760253906
  Max value: 2.8007497787475586
  Mean value: -11.111824035644531

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.852410316467285
  Max value: 20.794044494628906
  Mean value: 8.9417724609375

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.942512035369873
  Max value: 13.313774108886719
  Mean value: 2.648970127105713

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.3687210083007812
  Max value: 10.2069730758667
  Mean value: 2.8155345916748047

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.9392170906066895
  Max value: 6.22070837020874
  Mean value: 0.32260721921920776

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 1.8501516580581665
  Max value: 14.487051010131836
  Mean value: 6.70065450668335

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1123, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.9482903480529785
  Max value: 6.758693218231201
  Mean value: -1.2477129697799683

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.860577583312988
  Max value: 2.2178328037261963
  Mean value: -4.8598103523254395

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.255509376525879
  Max value: 8.757829666137695
  Mean value: 1.3728218078613281

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.011772155761719
  Max value: 2.016291379928589
  Mean value: -2.8789854049682617

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.62909698486328
  Max value: 18.226699829101562
  Mean value: 2.0487117767333984

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([89, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.579994201660156
  Max value: 17.419403076171875
  Mean value: 2.2420103549957275

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.995205879211426
  Max value: 8.927953720092773
  Mean value: 1.4105030298233032

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([15, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.007369518280029
  Max value: 6.539975166320801
  Mean value: 0.49543678760528564

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([59, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.4571027755737305
  Max value: 13.466394424438477
  Mean value: 0.715962290763855

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.745635986328125
  Max value: 4.3208465576171875
  Mean value: -11.992294311523438
Total examples processed: 640

Processing batch 6
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([202, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.8494181632995605
  Max value: 11.514245986938477
  Mean value: 1.02907395362854

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.33194923400879
  Max value: 27.91261100769043
  Mean value: 2.8137388229370117

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.048490524291992
  Max value: 28.15863037109375
  Mean value: 2.915156602859497

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.949800491333008
  Max value: 27.53827667236328
  Mean value: 2.6160666942596436

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.955106735229492
  Max value: 29.107406616210938
  Mean value: 2.6954760551452637

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.941347122192383
  Max value: 28.69784927368164
  Mean value: 2.7621049880981445

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.818411827087402
  Max value: 10.673381805419922
  Mean value: -0.06964210420846939

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.195018768310547
  Max value: 14.109197616577148
  Mean value: 1.4260777235031128

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.004416465759277
  Max value: 13.200837135314941
  Mean value: 2.0477817058563232

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.687041282653809
  Max value: 13.565069198608398
  Mean value: 2.0311014652252197

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.790786743164062
  Max value: 16.719083786010742
  Mean value: 0.08325661718845367

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.688472747802734
  Max value: 10.180787086486816
  Mean value: -0.6801765561103821

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.45376205444336
  Max value: 36.93775177001953
  Mean value: -0.06291059404611588

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([68, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -34.56294250488281
  Max value: 47.88190460205078
  Mean value: 2.389282703399658

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.661794185638428
  Max value: 21.295936584472656
  Mean value: 1.3069974184036255

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4602, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.51343536376953
  Max value: 14.713030815124512
  Mean value: -9.13275146484375

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([251, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.830198287963867
  Max value: 1.3064810037612915
  Mean value: -10.585561752319336

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.888124465942383
  Max value: 19.56828498840332
  Mean value: 4.759303569793701

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.310214519500732
  Max value: 23.825063705444336
  Mean value: 6.0140533447265625

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.914529800415039
  Max value: 9.234232902526855
  Mean value: 0.336963415145874

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.913728713989258
  Max value: 10.58495044708252
  Mean value: 1.5122935771942139

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.1225919723510742
  Max value: 14.95823860168457
  Mean value: 6.279698371887207

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1037, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.348701477050781
  Max value: 8.596603393554688
  Mean value: -1.2323359251022339

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.074769020080566
  Max value: 10.394231796264648
  Mean value: -1.2900638580322266

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.9380526542663574
  Max value: 4.798094272613525
  Mean value: 0.7617926001548767

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.556867599487305
  Max value: 18.879261016845703
  Mean value: 2.802027702331543

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.195146560668945
  Max value: 27.068988800048828
  Mean value: 2.403247356414795

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.971132278442383
  Max value: 20.653657913208008
  Mean value: 2.274998426437378

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.533202171325684
  Max value: 7.901572227478027
  Mean value: 1.4693987369537354

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([16, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.634887933731079
  Max value: 4.374046802520752
  Mean value: -0.2168569564819336

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([118, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.889768123626709
  Max value: 11.331924438476562
  Mean value: 0.5374426245689392

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.57723617553711
  Max value: -11.06740951538086
  Mean value: -19.277727127075195
Total examples processed: 768

Processing batch 7
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([209, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.230806350708008
  Max value: 10.629012107849121
  Mean value: 1.015184998512268

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.46257209777832
  Max value: 20.74203872680664
  Mean value: -4.637755393981934

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.00608253479004
  Max value: 21.631576538085938
  Mean value: -5.229613304138184

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.342798233032227
  Max value: -3.4823555946350098
  Mean value: -9.55906867980957

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.433076858520508
  Max value: 24.369043350219727
  Mean value: -5.233434200286865

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.12043571472168
  Max value: 21.651653289794922
  Mean value: -4.690513610839844

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.072017669677734
  Max value: 6.8253173828125
  Mean value: -0.14326894283294678

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([90, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.796032905578613
  Max value: 10.711641311645508
  Mean value: 1.44011652469635

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.824448585510254
  Max value: 14.651955604553223
  Mean value: 1.7157363891601562

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.531386375427246
  Max value: 14.175878524780273
  Mean value: 1.7497364282608032

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.705385208129883
  Max value: 21.783266067504883
  Mean value: -0.002914340002462268

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.08161163330078
  Max value: 14.223901748657227
  Mean value: -0.733708918094635

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -38.18281936645508
  Max value: 30.30878257751465
  Mean value: -0.7850703597068787

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -42.89309310913086
  Max value: 46.346187591552734
  Mean value: 1.05682373046875

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([91, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.421921730041504
  Max value: 17.28709602355957
  Mean value: 1.3310562372207642

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5722, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.238937377929688
  Max value: 11.789320945739746
  Mean value: -9.224257469177246

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([119, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.88522720336914
  Max value: 1.8878991603851318
  Mean value: -12.283164978027344

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.848139762878418
  Max value: 11.153402328491211
  Mean value: 0.9273843169212341

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 0.8231186866760254
  Max value: 13.35456371307373
  Mean value: 2.6819005012512207

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.194811820983887
  Max value: 14.32135009765625
  Mean value: -0.9175885915756226

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.131685256958008
  Max value: 3.2360455989837646
  Mean value: -2.5611727237701416

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.972902774810791
  Max value: 2.1068015098571777
  Mean value: -4.381327152252197

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1065, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.684538841247559
  Max value: 8.074891090393066
  Mean value: -1.1320308446884155

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.422807693481445
  Max value: -4.346590518951416
  Mean value: -9.08788776397705

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.618241310119629
  Max value: 0.3839988708496094
  Mean value: -1.8850740194320679

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.313868522644043
  Max value: -2.4045557975769043
  Mean value: -5.633622646331787

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([91, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.933122634887695
  Max value: 23.3487548828125
  Mean value: 1.8831197023391724

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.880569458007812
  Max value: 18.260656356811523
  Mean value: 1.4067045450210571

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.494065284729004
  Max value: 8.772680282592773
  Mean value: 1.359523892402649

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([31, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.838921070098877
  Max value: 8.17854118347168
  Mean value: 0.23860932886600494

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([61, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.7912986278533936
  Max value: 8.819546699523926
  Mean value: 0.283950537443161

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.16471290588379
  Max value: -3.4646730422973633
  Mean value: -13.785099029541016
Total examples processed: 896

Processing batch 8
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([259, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.423961162567139
  Max value: 11.993309020996094
  Mean value: 1.1038146018981934

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.028430938720703
  Max value: 22.464218139648438
  Mean value: -1.1867706775665283

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.50874137878418
  Max value: 26.496946334838867
  Mean value: 0.3441356122493744

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.338157653808594
  Max value: 26.8635311126709
  Mean value: 1.7943825721740723

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.71013641357422
  Max value: 25.112674713134766
  Mean value: 0.3301926553249359

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.294042587280273
  Max value: 28.304719924926758
  Mean value: 0.3800543248653412

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.999145030975342
  Max value: 6.971766948699951
  Mean value: -0.08945928514003754

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.361347198486328
  Max value: 10.843957901000977
  Mean value: 1.6726136207580566

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.529206275939941
  Max value: 14.296916007995605
  Mean value: 2.249865770339966

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.693854331970215
  Max value: 11.331597328186035
  Mean value: 1.9713671207427979

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([87, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.555952072143555
  Max value: 9.609201431274414
  Mean value: 0.06407300382852554

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.58576011657715
  Max value: 9.610281944274902
  Mean value: -0.7410451769828796

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([88, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.236459732055664
  Max value: 36.297637939453125
  Mean value: 0.0725640207529068

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -33.39373016357422
  Max value: 50.24510192871094
  Mean value: 1.9689322710037231

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.448324203491211
  Max value: 19.26097297668457
  Mean value: 1.5247962474822998

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4856, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.8297176361084
  Max value: 18.803150177001953
  Mean value: -8.96861743927002

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([206, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.59552574157715
  Max value: 1.9214808940887451
  Mean value: -11.549152374267578

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.867448806762695
  Max value: 19.104623794555664
  Mean value: 8.593653678894043

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 5.043368339538574
  Max value: 13.920855522155762
  Mean value: 6.811514854431152

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.854205369949341
  Max value: 14.008260726928711
  Mean value: 5.129234313964844

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.3369603157043457
  Max value: 5.605302810668945
  Mean value: 0.7809762954711914

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 1.373152732849121
  Max value: 3.917518138885498
  Mean value: 2.6590476036071777

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1154, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.124972343444824
  Max value: 10.243476867675781
  Mean value: -1.1984668970108032

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.985271453857422
  Max value: 4.860295295715332
  Mean value: -3.723397970199585

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.0366971492767334
  Max value: 10.028385162353516
  Mean value: 0.3614036738872528

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.437923431396484
  Max value: 4.488492965698242
  Mean value: -0.2794201970100403

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.585994720458984
  Max value: 20.931259155273438
  Mean value: 2.3387646675109863

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.22593116760254
  Max value: 22.47214698791504
  Mean value: 2.037309408187866

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.897703170776367
  Max value: 9.157846450805664
  Mean value: 1.5759997367858887

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([106, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.971674919128418
  Max value: 14.620397567749023
  Mean value: 5.828152179718018

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.8167972564697266
  Max value: 10.90054988861084
  Mean value: 0.31828999519348145

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.953025817871094
  Max value: -11.223869323730469
  Mean value: -19.73784637451172
Total examples processed: 1024

Processing batch 9
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([192, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.464025974273682
  Max value: 11.009740829467773
  Mean value: 0.9124621152877808

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.71539306640625
  Max value: 24.410541534423828
  Mean value: -0.21996842324733734

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.28464126586914
  Max value: 24.39773178100586
  Mean value: 0.7879876494407654

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.44527244567871
  Max value: 12.640446662902832
  Mean value: -2.349400281906128

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.494709014892578
  Max value: 23.535079956054688
  Mean value: -1.4410680532455444

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.410879135131836
  Max value: 24.91019058227539
  Mean value: -1.5381169319152832

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.58816385269165
  Max value: 7.1785173416137695
  Mean value: -0.10628532618284225

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.564281463623047
  Max value: 10.294964790344238
  Mean value: 1.5957977771759033

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([89, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.408377647399902
  Max value: 15.703237533569336
  Mean value: 2.285968542098999

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.985713005065918
  Max value: 12.81491470336914
  Mean value: 2.5611422061920166

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.385236740112305
  Max value: 8.808246612548828
  Mean value: 0.060169339179992676

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.457009315490723
  Max value: 14.709775924682617
  Mean value: -0.7237250804901123

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.547805786132812
  Max value: 34.86732482910156
  Mean value: 0.14257346093654633

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -30.85344696044922
  Max value: 41.741188049316406
  Mean value: 3.1264545917510986

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.392106056213379
  Max value: 22.73869514465332
  Mean value: 1.5193463563919067

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5140, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.4556827545166
  Max value: 6.73834753036499
  Mean value: -8.92723560333252

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([141, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.55900001525879
  Max value: 3.2815983295440674
  Mean value: -9.965665817260742

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.782556056976318
  Max value: 23.166913986206055
  Mean value: 7.811677932739258

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.2995057106018066
  Max value: 15.632840156555176
  Mean value: 5.233933925628662

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.974855422973633
  Max value: 25.979843139648438
  Mean value: 6.593048095703125

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.297040939331055
  Max value: 5.19934606552124
  Mean value: -2.4639594554901123

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.2907025814056396
  Max value: 10.193208694458008
  Mean value: 2.987189769744873

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1308, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.454428672790527
  Max value: 7.212908744812012
  Mean value: -1.3003298044204712

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.800857543945312
  Max value: 11.093542098999023
  Mean value: -2.196575164794922

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.504568576812744
  Max value: 4.594379425048828
  Mean value: -0.8852556943893433

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.7930269241333
  Max value: 13.111055374145508
  Mean value: -0.027303095906972885

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.00421905517578
  Max value: 25.382211685180664
  Mean value: 2.170886754989624

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([88, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.93730354309082
  Max value: 24.563846588134766
  Mean value: 2.012542724609375

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([87, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.622918128967285
  Max value: 10.719276428222656
  Mean value: 1.5542826652526855

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.366039276123047
  Max value: 1.7877424955368042
  Mean value: -0.17520421743392944

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([123, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.541909217834473
  Max value: 13.292516708374023
  Mean value: 0.5933367013931274

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.91554832458496
  Max value: 5.707817554473877
  Mean value: -9.747016906738281
Total examples processed: 1152

Processing batch 10
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([189, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.399532318115234
  Max value: 10.943115234375
  Mean value: 0.9884428977966309

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.521754264831543
  Max value: 20.628889083862305
  Mean value: 1.9906926155090332

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.781784057617188
  Max value: 20.560546875
  Mean value: 1.5978561639785767

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.013551712036133
  Max value: 11.155193328857422
  Mean value: -0.17470639944076538

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.407928466796875
  Max value: 9.126960754394531
  Mean value: 1.2406567335128784

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.872159957885742
  Max value: 13.802350044250488
  Mean value: 1.9001541137695312

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.484136581420898
  Max value: 15.168129920959473
  Mean value: 1.955541968345642

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.025985717773438
  Max value: 17.361774444580078
  Mean value: -0.045333363115787506

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.76196575164795
  Max value: 21.882062911987305
  Mean value: -0.753176212310791

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -38.205970764160156
  Max value: 49.03055191040039
  Mean value: -0.4521428048610687

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.142494201660156
  Max value: 33.337303161621094
  Mean value: 1.1355324983596802

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.04751205444336
  Max value: 18.157917022705078
  Mean value: 1.3748135566711426

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4721, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.578121185302734
  Max value: 9.560310363769531
  Mean value: -9.145605087280273

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([42, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.017810821533203
  Max value: 1.9224940538406372
  Mean value: -10.868282318115234

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 0.6078166961669922
  Max value: 10.026449203491211
  Mean value: 2.5766172409057617

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.284639358520508
  Max value: 6.820705413818359
  Mean value: 2.0234408378601074

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -0.8960976600646973
  Max value: 6.800511360168457
  Mean value: 2.257392406463623

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 3.298704147338867
  Max value: 10.169647216796875
  Mean value: 6.521341323852539

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1315, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.361749649047852
  Max value: 13.66254997253418
  Mean value: -1.3469045162200928

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 1.4353618621826172
  Max value: 9.039844512939453
  Mean value: 3.4634170532226562

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.68850326538086
  Max value: -0.8759279251098633
  Mean value: -3.513953924179077

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.333194732666016
  Max value: 22.13138198852539
  Mean value: 1.6452152729034424

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.46218490600586
  Max value: 16.51644515991211
  Mean value: 1.532400369644165

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([65, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.142301559448242
  Max value: 14.810708999633789
  Mean value: 1.4263876676559448

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([34, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.133870601654053
  Max value: 5.305081367492676
  Mean value: -0.32835274934768677

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([196, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.813608407974243
  Max value: 11.891031265258789
  Mean value: 1.1960217952728271

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.99644660949707
  Max value: -10.653816223144531
  Mean value: -18.354225158691406
Total examples processed: 1280

Processing batch 11
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([219, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.317061901092529
  Max value: 10.147221565246582
  Mean value: 1.0965248346328735

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.851661682128906
  Max value: 23.934146881103516
  Mean value: 1.563971757888794

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.457145690917969
  Max value: 23.17985725402832
  Mean value: 2.617640972137451

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.810037612915039
  Max value: 23.266386032104492
  Mean value: 3.018665075302124

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.08476448059082
  Max value: 25.470237731933594
  Mean value: 0.5288113355636597

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.253652572631836
  Max value: 23.432811737060547
  Mean value: -0.19791001081466675

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.233452796936035
  Max value: 7.5644659996032715
  Mean value: -0.16097620129585266

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.36016273498535
  Max value: 10.454980850219727
  Mean value: 1.617411494255066

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.540628433227539
  Max value: 16.2558650970459
  Mean value: 2.2006406784057617

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.496150970458984
  Max value: 14.894723892211914
  Mean value: 2.3282227516174316

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.549213409423828
  Max value: 34.39873123168945
  Mean value: 0.11817223578691483

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.849803924560547
  Max value: 29.607425689697266
  Mean value: -0.6652271747589111

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([88, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.499752044677734
  Max value: 36.65861892700195
  Mean value: -0.18133120238780975

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -35.33929443359375
  Max value: 47.41768264770508
  Mean value: 3.6584579944610596

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.976158142089844
  Max value: 18.689714431762695
  Mean value: 1.88375985622406

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5529, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.52652931213379
  Max value: 15.908324241638184
  Mean value: -9.252457618713379

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([95, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.703805923461914
  Max value: 2.8058738708496094
  Mean value: -8.500560760498047

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.643288612365723
  Max value: 19.2337703704834
  Mean value: 8.359636306762695

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.7885582447052
  Max value: 13.340158462524414
  Mean value: 4.43080472946167

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.139139652252197
  Max value: 26.80918312072754
  Mean value: 7.254232883453369

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.795723915100098
  Max value: 10.455574035644531
  Mean value: 1.1608136892318726

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.838688850402832
  Max value: 12.131965637207031
  Mean value: 4.99059534072876

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1162, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.363226890563965
  Max value: 15.649904251098633
  Mean value: -1.2737244367599487

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.704669952392578
  Max value: 12.073326110839844
  Mean value: -2.834413766860962

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.902968168258667
  Max value: 7.660090446472168
  Mean value: 0.8060712218284607

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.279204368591309
  Max value: 7.500619411468506
  Mean value: 0.21926559507846832

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.661808013916016
  Max value: 26.825374603271484
  Mean value: 2.9582877159118652

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.22768211364746
  Max value: 27.17839241027832
  Mean value: 2.4009413719177246

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.208236694335938
  Max value: 12.606128692626953
  Mean value: 1.6564215421676636

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([129, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.737156867980957
  Max value: 12.735197067260742
  Mean value: 1.2561852931976318

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.515260696411133
  Max value: 5.780929088592529
  Mean value: -13.047106742858887
Total examples processed: 1408

Processing batch 12
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([209, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.13808012008667
  Max value: 13.208749771118164
  Mean value: 1.0448312759399414

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.263568878173828
  Max value: 8.37976360321045
  Mean value: 1.9471216201782227

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.866209030151367
  Max value: -0.36919093132019043
  Mean value: -6.840554237365723

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.378957748413086
  Max value: 8.397867202758789
  Mean value: -2.4004483222961426

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.284677505493164
  Max value: 8.885613441467285
  Mean value: -2.5530593395233154

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.281673431396484
  Max value: 9.148194313049316
  Mean value: -2.4197065830230713

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.750517845153809
  Max value: 6.48329496383667
  Mean value: -0.10013265162706375

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.477472305297852
  Max value: 10.210957527160645
  Mean value: 1.6040619611740112

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([88, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.272422790527344
  Max value: 11.739069938659668
  Mean value: 2.17016339302063

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.446329116821289
  Max value: 11.935855865478516
  Mean value: 2.1051506996154785

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.999424934387207
  Max value: 12.96847915649414
  Mean value: 0.054790522903203964

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([88, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.766687393188477
  Max value: 10.3834810256958
  Mean value: -0.7495558857917786

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.336240768432617
  Max value: 35.891868591308594
  Mean value: 0.4228765666484833

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.217517852783203
  Max value: 41.710052490234375
  Mean value: 2.7870965003967285

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.642611503601074
  Max value: 15.33726978302002
  Mean value: 1.4633054733276367

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4840, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.69043731689453
  Max value: 12.020341873168945
  Mean value: -8.963640213012695

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([147, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.252971649169922
  Max value: 0.35125166177749634
  Mean value: -12.167844772338867

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.570497512817383
  Max value: 12.515581130981445
  Mean value: 2.9268088340759277

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.562784671783447
  Max value: 12.967073440551758
  Mean value: 3.557708740234375

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.314340591430664
  Max value: 16.654748916625977
  Mean value: 0.7681249380111694

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.834214925765991
  Max value: 3.4355549812316895
  Mean value: 0.09090599417686462

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.370438575744629
  Max value: 6.221974849700928
  Mean value: 0.8837660551071167

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1382, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.166393280029297
  Max value: 11.295557975769043
  Mean value: -1.333237648010254

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.572944641113281
  Max value: 13.407459259033203
  Mean value: 0.3523492217063904

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -0.3538628816604614
  Max value: 3.1220338344573975
  Mean value: 1.5524547100067139

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.560735702514648
  Max value: 13.106818199157715
  Mean value: -1.0726032257080078

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.535371780395508
  Max value: 18.510223388671875
  Mean value: 2.4108827114105225

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.22068977355957
  Max value: 19.37351417541504
  Mean value: 2.30726957321167

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.942018508911133
  Max value: 8.54024887084961
  Mean value: 1.5325982570648193

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([47, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.644454002380371
  Max value: 7.200198650360107
  Mean value: 0.7856200933456421

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([38, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.244753837585449
  Max value: 6.285422325134277
  Mean value: 0.31161367893218994

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.557069778442383
  Max value: -12.916417121887207
  Mean value: -20.782316207885742
Total examples processed: 1536

Processing batch 13
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([208, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.111577033996582
  Max value: 13.538887977600098
  Mean value: 1.030118703842163

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.16385269165039
  Max value: 3.946943521499634
  Mean value: -1.524716854095459

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.25127601623535
  Max value: 7.387737274169922
  Mean value: -2.102303981781006

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.822750091552734
  Max value: 3.738867998123169
  Mean value: -3.299931287765503

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.337587356567383
  Max value: 7.4477972984313965
  Mean value: -1.1009129285812378

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.776247024536133
  Max value: 7.29965353012085
  Mean value: -1.7963606119155884

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([68, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.424801826477051
  Max value: 10.543984413146973
  Mean value: -0.17646318674087524

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([66, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.814192771911621
  Max value: 11.082582473754883
  Mean value: 1.6506553888320923

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.8912787437438965
  Max value: 13.124068260192871
  Mean value: 2.1881260871887207

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.001296997070312
  Max value: 11.403827667236328
  Mean value: 2.2550222873687744

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.205682754516602
  Max value: 16.167625427246094
  Mean value: 0.12772519886493683

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.587342262268066
  Max value: 16.75040054321289
  Mean value: -0.6011525988578796

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.763835906982422
  Max value: 55.20037841796875
  Mean value: 0.48771411180496216

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -31.807331085205078
  Max value: 68.19742584228516
  Mean value: 3.4552783966064453

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([68, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.201325416564941
  Max value: 15.56937026977539
  Mean value: 1.6942670345306396

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5244, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.893892288208008
  Max value: 15.164135932922363
  Mean value: -9.000965118408203

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([257, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.866378784179688
  Max value: 0.6835976839065552
  Mean value: -10.62614631652832

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.277120590209961
  Max value: 5.056256294250488
  Mean value: 0.9710166454315186

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.9685364961624146
  Max value: 10.164819717407227
  Mean value: 3.010082721710205

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.383143901824951
  Max value: 13.927775382995605
  Mean value: 2.6795287132263184

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.800511837005615
  Max value: 4.322965621948242
  Mean value: -0.5541086792945862

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.4541491270065308
  Max value: 5.860130310058594
  Mean value: 2.4729788303375244

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1190, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.154151916503906
  Max value: 10.367546081542969
  Mean value: -1.3674821853637695

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 3.2411062717437744
  Max value: 6.987613677978516
  Mean value: 5.040914535522461

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.3306102752685547
  Max value: 2.766212224960327
  Mean value: -0.1506182700395584

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.57747745513916
  Max value: 14.248833656311035
  Mean value: 1.1503288745880127

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.50189208984375
  Max value: 31.547517776489258
  Mean value: 2.4633069038391113

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.533517837524414
  Max value: 28.593585968017578
  Mean value: 1.7958393096923828

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.31473731994629
  Max value: 10.577279090881348
  Mean value: 1.432681679725647

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([67, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.59600830078125
  Max value: 3.9988951683044434
  Mean value: -0.13237117230892181

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([147, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.350279808044434
  Max value: 12.077005386352539
  Mean value: 0.3534873425960541

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([8, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.01152992248535
  Max value: 1.4842091798782349
  Mean value: -12.830144882202148
Total examples processed: 1664

Processing batch 14
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([209, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.116302013397217
  Max value: 11.934013366699219
  Mean value: 1.0171163082122803

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.726399421691895
  Max value: 23.056737899780273
  Mean value: 1.1364272832870483

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.253161430358887
  Max value: 19.082529067993164
  Mean value: 2.297567844390869

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.388969421386719
  Max value: 21.368864059448242
  Mean value: 1.7896581888198853

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.045961380004883
  Max value: 21.77044677734375
  Mean value: 0.8519947528839111

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.589323043823242
  Max value: 22.92117691040039
  Mean value: 1.931243658065796

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.488407135009766
  Max value: 6.884031295776367
  Mean value: -0.13635404407978058

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.697370529174805
  Max value: 9.883938789367676
  Mean value: 1.7604038715362549

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.707526206970215
  Max value: 13.644930839538574
  Mean value: 2.0457077026367188

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.466221809387207
  Max value: 12.043079376220703
  Mean value: 2.0900189876556396

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.736687660217285
  Max value: 17.442394256591797
  Mean value: -0.08673977106809616

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.685457229614258
  Max value: 6.20310640335083
  Mean value: -0.8028020858764648

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.448801040649414
  Max value: 48.46470260620117
  Mean value: -0.2876746952533722

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -40.086097717285156
  Max value: 55.710819244384766
  Mean value: 2.103947877883911

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.201910972595215
  Max value: 19.997953414916992
  Mean value: 1.3936575651168823

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4688, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.21881866455078
  Max value: 12.727665901184082
  Mean value: -8.986113548278809

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([64, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.010005950927734
  Max value: 4.488205909729004
  Mean value: -7.533489227294922

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.969810962677002
  Max value: 20.3171329498291
  Mean value: 14.287215232849121

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 4.400294303894043
  Max value: 17.382862091064453
  Mean value: 7.5931854248046875

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.510343551635742
  Max value: 10.951339721679688
  Mean value: 1.9523433446884155

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.912378311157227
  Max value: 10.329523086547852
  Mean value: 1.9167394638061523

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 1.9345192909240723
  Max value: 12.20228385925293
  Mean value: 6.370116233825684

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1221, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.846490859985352
  Max value: 9.044918060302734
  Mean value: -1.4005497694015503

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.402238845825195
  Max value: 5.870465278625488
  Mean value: -3.399265766143799

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.827266216278076
  Max value: 15.045085906982422
  Mean value: 1.0542068481445312

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.505322456359863
  Max value: 4.1219329833984375
  Mean value: -0.629205048084259

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.269498825073242
  Max value: 25.249980926513672
  Mean value: 2.306809186935425

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.270967483520508
  Max value: 19.46259880065918
  Mean value: 1.989554524421692

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.71813678741455
  Max value: 8.479769706726074
  Mean value: 1.390278697013855

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.730922698974609
  Max value: 6.558381080627441
  Mean value: 0.9856786131858826

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([254, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.653975486755371
  Max value: 11.717164039611816
  Mean value: 0.638608455657959

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.96973419189453
  Max value: 1.992742657661438
  Mean value: -15.518683433532715
Total examples processed: 1792

Processing batch 15
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([160, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.014941692352295
  Max value: 10.154062271118164
  Mean value: 1.0475245714187622

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.923660278320312
  Max value: 23.88786506652832
  Mean value: -2.4766297340393066

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.048410415649414
  Max value: 24.12371063232422
  Mean value: -2.1538169384002686

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.27933692932129
  Max value: 24.084747314453125
  Mean value: -2.103238821029663

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.76354217529297
  Max value: 24.395307540893555
  Mean value: -2.213531255722046

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.74944305419922
  Max value: 24.94202995300293
  Mean value: -1.8661998510360718

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.594618797302246
  Max value: 8.181706428527832
  Mean value: -0.14597618579864502

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.392181396484375
  Max value: 10.042526245117188
  Mean value: 1.9599308967590332

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.380950927734375
  Max value: 13.878341674804688
  Mean value: 2.2303528785705566

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.767786026000977
  Max value: 13.40031623840332
  Mean value: 2.341371536254883

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.175261497497559
  Max value: 16.340471267700195
  Mean value: -0.06153939291834831

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.566431045532227
  Max value: 10.883018493652344
  Mean value: -0.7462761998176575

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.954998016357422
  Max value: 35.738311767578125
  Mean value: 0.6971624493598938

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.994022369384766
  Max value: 49.341270446777344
  Mean value: 3.493471145629883

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.80348014831543
  Max value: 18.22060203552246
  Mean value: 1.5444785356521606

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4850, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.60846519470215
  Max value: 6.075536251068115
  Mean value: -9.066640853881836

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([192, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.432371139526367
  Max value: 6.587152481079102
  Mean value: -8.66720199584961

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.524263858795166
  Max value: 17.526885986328125
  Mean value: 3.336859941482544

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.637296199798584
  Max value: 10.964675903320312
  Mean value: 3.514648675918579

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.051603317260742
  Max value: 11.032098770141602
  Mean value: 0.3726986348628998

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.477775573730469
  Max value: 5.275533676147461
  Mean value: -0.335610568523407

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.189284324645996
  Max value: 13.718914985656738
  Mean value: 3.5732409954071045

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1033, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.153075218200684
  Max value: 8.008642196655273
  Mean value: -1.3314751386642456

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.983024597167969
  Max value: 7.492602348327637
  Mean value: -2.8881165981292725

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.65976619720459
  Max value: 2.174739122390747
  Mean value: -0.6088300943374634

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.139371871948242
  Max value: 9.98807430267334
  Mean value: -0.8001189231872559

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.43421745300293
  Max value: 23.660762786865234
  Mean value: 2.6623411178588867

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([65, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.015838623046875
  Max value: 24.804439544677734
  Mean value: 2.40840220451355

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([69, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.637997627258301
  Max value: 10.806157112121582
  Mean value: 1.584275484085083

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([286, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.586767196655273
  Max value: 11.554491996765137
  Mean value: 0.7068288922309875

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.71517562866211
  Max value: 4.330909252166748
  Mean value: -11.202637672424316
Total examples processed: 1920

Processing batch 16
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([179, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.271267890930176
  Max value: 10.426712989807129
  Mean value: 0.870655357837677

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.939298629760742
  Max value: -2.5577449798583984
  Mean value: -7.83828067779541

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.63308334350586
  Max value: 29.54739761352539
  Mean value: -0.15399107336997986

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.43583869934082
  Max value: -3.2596707344055176
  Mean value: -7.902113914489746

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.267516136169434
  Max value: 29.297895431518555
  Mean value: 8.164690017700195

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.990726470947266
  Max value: -2.9524924755096436
  Mean value: -7.930654525756836

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.232386112213135
  Max value: 8.50576400756836
  Mean value: -0.14389851689338684

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([68, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.091733932495117
  Max value: 9.057689666748047
  Mean value: 1.4677259922027588

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.467482566833496
  Max value: 14.03065013885498
  Mean value: 1.9271098375320435

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.152092933654785
  Max value: 12.64197063446045
  Mean value: 2.1563103199005127

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.38102912902832
  Max value: 23.19506072998047
  Mean value: -0.06323131173849106

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.636966705322266
  Max value: 14.017533302307129
  Mean value: -0.745591938495636

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.79738426208496
  Max value: 34.1338996887207
  Mean value: 0.3153475224971771

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.798686981201172
  Max value: 45.93096923828125
  Mean value: 2.780946969985962

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.142241477966309
  Max value: 12.191542625427246
  Mean value: 1.1079329252243042

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5510, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.327123641967773
  Max value: 11.81489372253418
  Mean value: -9.224990844726562

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([10, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.008403778076172
  Max value: 2.49360728263855
  Mean value: -7.0013813972473145

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.476229190826416
  Max value: 21.691802978515625
  Mean value: 6.697079181671143

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.446527481079102
  Max value: 18.681015014648438
  Mean value: 3.9136080741882324

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.015583515167236
  Max value: -1.2099335193634033
  Mean value: -4.652482509613037

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.098046779632568
  Max value: 11.607035636901855
  Mean value: 1.4056318998336792

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.092186450958252
  Max value: 0.38532358407974243
  Mean value: -1.7683217525482178

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([869, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.88182258605957
  Max value: 8.3818359375
  Mean value: -1.2948921918869019

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.453805923461914
  Max value: -0.6803374290466309
  Mean value: -5.997345447540283

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.237112045288086
  Max value: 1.5700808763504028
  Mean value: -2.4715793132781982

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.4317474365234375
  Max value: 4.445995330810547
  Mean value: 1.1751620769500732

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.3959903717041
  Max value: 23.188371658325195
  Mean value: 2.1508419513702393

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.990896224975586
  Max value: 22.68191146850586
  Mean value: 1.8442857265472412

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.207202911376953
  Max value: 10.088492393493652
  Mean value: 1.4518961906433105

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([46, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.157449245452881
  Max value: 6.744391441345215
  Mean value: -0.2758750021457672

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([163, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.495876789093018
  Max value: 11.6142578125
  Mean value: 0.6782771944999695

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.32293701171875
  Max value: -9.701539039611816
  Mean value: -19.12040138244629
Total examples processed: 2048

Processing batch 17
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([215, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.268701076507568
  Max value: 12.575506210327148
  Mean value: 0.9946553111076355

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -31.094837188720703
  Max value: 37.36532211303711
  Mean value: 1.1931577920913696

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.15126609802246
  Max value: 31.16697883605957
  Mean value: -0.4906477928161621

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.81241798400879
  Max value: 31.318967819213867
  Mean value: -0.5478430986404419

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.087570190429688
  Max value: 36.92130661010742
  Mean value: 1.250793218612671

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.735538482666016
  Max value: -3.3796892166137695
  Mean value: -7.807507514953613

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.589569568634033
  Max value: 9.06347370147705
  Mean value: -0.1353868991136551

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.944774627685547
  Max value: 11.035697937011719
  Mean value: 1.5458343029022217

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.179800033569336
  Max value: 15.484543800354004
  Mean value: 2.0688509941101074

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.148542404174805
  Max value: 14.878002166748047
  Mean value: 2.0291764736175537

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.709379196166992
  Max value: 18.711427688598633
  Mean value: -0.02615700289607048

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.9412841796875
  Max value: 17.536441802978516
  Mean value: -0.8380804061889648

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -44.39900207519531
  Max value: 43.53915023803711
  Mean value: -0.06887074559926987

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -49.73371124267578
  Max value: 44.433998107910156
  Mean value: 2.3549439907073975

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.821327209472656
  Max value: 16.805587768554688
  Mean value: 1.4594740867614746

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4821, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.201730728149414
  Max value: 19.580718994140625
  Mean value: -9.028641700744629

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([34, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.324918746948242
  Max value: 3.0616295337677
  Mean value: -7.381317615509033

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.245132446289062
  Max value: 23.890758514404297
  Mean value: 7.112524032592773

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.9068228006362915
  Max value: 21.451217651367188
  Mean value: 6.706296443939209

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.673904418945312
  Max value: -2.707284927368164
  Mean value: -6.048734664916992

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.5263161659240723
  Max value: 3.6887922286987305
  Mean value: 0.8106814622879028

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1034, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.925671577453613
  Max value: 9.243148803710938
  Mean value: -1.2616664171218872

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.888992309570312
  Max value: -6.092324256896973
  Mean value: -8.181344985961914

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.2114899158477783
  Max value: 2.1260294914245605
  Mean value: -0.5319031476974487

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.052678108215332
  Max value: -1.1416683197021484
  Mean value: -4.572453498840332

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -35.81011962890625
  Max value: 37.457740783691406
  Mean value: 2.197392702102661

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.204723358154297
  Max value: 18.518775939941406
  Mean value: 2.146476984024048

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.031975746154785
  Max value: 12.280094146728516
  Mean value: 1.3216426372528076

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.7940497398376465
  Max value: 9.268633842468262
  Mean value: 0.34271174669265747

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([171, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.448306083679199
  Max value: 12.157853126525879
  Mean value: 0.6886855959892273

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.750972747802734
  Max value: 4.091447830200195
  Mean value: -9.490460395812988
Total examples processed: 2176

Processing batch 18
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([226, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.906174182891846
  Max value: 10.53936767578125
  Mean value: 1.0299327373504639

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([9, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.943206787109375
  Max value: 24.49041175842285
  Mean value: -0.38830846548080444

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.841020584106445
  Max value: 23.987646102905273
  Mean value: -2.304757833480835

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([9, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.327194213867188
  Max value: 25.378156661987305
  Mean value: 0.23228076100349426

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.80739974975586
  Max value: 27.331579208374023
  Mean value: 0.7787177562713623

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([9, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.25176239013672
  Max value: 25.948453903198242
  Mean value: -0.16800406575202942

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.444167613983154
  Max value: 7.676379680633545
  Mean value: -0.10405852645635605

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([68, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.212214469909668
  Max value: 8.798611640930176
  Mean value: 1.6228095293045044

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.334393501281738
  Max value: 17.92691993713379
  Mean value: 2.373152494430542

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.231441497802734
  Max value: 17.238361358642578
  Mean value: 2.443286180496216

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.660172462463379
  Max value: 18.045543670654297
  Mean value: 0.0673755407333374

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.794601440429688
  Max value: 12.697906494140625
  Mean value: -0.6887204051017761

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.71044921875
  Max value: 31.640871047973633
  Mean value: -0.1002068892121315

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.8371524810791
  Max value: 49.405418395996094
  Mean value: 3.1241190433502197

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.349336624145508
  Max value: 20.37505340576172
  Mean value: 1.5526905059814453

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4702, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.827465057373047
  Max value: 5.507133960723877
  Mean value: -9.185739517211914

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([313, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.456571578979492
  Max value: 4.666528701782227
  Mean value: -10.120450019836426

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.641571044921875
  Max value: 21.726806640625
  Mean value: 7.689296722412109

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.9032573699951172
  Max value: 18.960105895996094
  Mean value: 4.165501594543457

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.046916961669922
  Max value: 9.738039016723633
  Mean value: 1.4466599225997925

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.94297456741333
  Max value: 8.228933334350586
  Mean value: 1.6069663763046265

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.724254608154297
  Max value: 12.925990104675293
  Mean value: 4.186532020568848

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1075, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.862503051757812
  Max value: 9.416754722595215
  Mean value: -1.3887765407562256

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.12152862548828
  Max value: 2.2791759967803955
  Mean value: -4.394936561584473

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.514382362365723
  Max value: 12.188651084899902
  Mean value: 0.1822046935558319

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.348381996154785
  Max value: 3.414318561553955
  Mean value: -3.4940290451049805

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.153047561645508
  Max value: 22.5146484375
  Mean value: 2.7137489318847656

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.07967185974121
  Max value: 25.49797821044922
  Mean value: 2.4352188110351562

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.747679710388184
  Max value: 10.187695503234863
  Mean value: 1.5554956197738647

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([22, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.463869333267212
  Max value: 7.778274059295654
  Mean value: 0.49537017941474915

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([143, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.930302619934082
  Max value: 12.027531623840332
  Mean value: 0.46799954771995544

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.512939453125
  Max value: 1.855879545211792
  Mean value: -11.759801864624023
Total examples processed: 2304

Processing batch 19
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([201, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.282935619354248
  Max value: 10.356657981872559
  Mean value: 1.07878577709198

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.33621597290039
  Max value: 2.5580620765686035
  Mean value: -3.2318766117095947

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.615650177001953
  Max value: 2.659956693649292
  Mean value: -3.132887363433838

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.932859420776367
  Max value: 2.792841911315918
  Mean value: -6.113109588623047

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.654975891113281
  Max value: 2.730252742767334
  Mean value: -1.7618107795715332

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.798606872558594
  Max value: 3.1918370723724365
  Mean value: -3.1939666271209717

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.970511436462402
  Max value: 7.538223743438721
  Mean value: -0.14425061643123627

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.762199401855469
  Max value: 11.791329383850098
  Mean value: 1.6241004467010498

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.539250373840332
  Max value: 13.85579776763916
  Mean value: 2.052103042602539

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.822784423828125
  Max value: 12.030702590942383
  Mean value: 2.0406911373138428

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.942073822021484
  Max value: 9.183418273925781
  Mean value: -0.11769148707389832

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.508492469787598
  Max value: 9.03271484375
  Mean value: -0.8089085817337036

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.78436279296875
  Max value: 26.452884674072266
  Mean value: -0.7784366011619568

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.704544067382812
  Max value: 37.98530197143555
  Mean value: 2.402944564819336

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.020233154296875
  Max value: 14.479388236999512
  Mean value: 1.4438331127166748

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5016, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.592361450195312
  Max value: 13.730023384094238
  Mean value: -9.154172897338867

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([185, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.92870330810547
  Max value: 0.23768669366836548
  Mean value: -13.199305534362793

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 1.1583199501037598
  Max value: 14.943910598754883
  Mean value: 12.195107460021973

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.250387191772461
  Max value: 8.851305961608887
  Mean value: 2.33721661567688

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.681201457977295
  Max value: 7.032860279083252
  Mean value: 1.5432085990905762

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -0.15949773788452148
  Max value: 5.719115257263184
  Mean value: 1.9525648355484009

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.248660922050476
  Max value: 2.5941696166992188
  Mean value: 0.8050433397293091

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1136, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.769775390625
  Max value: 8.271790504455566
  Mean value: -1.3316437005996704

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.814443111419678
  Max value: 5.7530717849731445
  Mean value: -1.4863859415054321

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.510064125061035
  Max value: 3.0860202312469482
  Mean value: -1.8025054931640625

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.460591793060303
  Max value: 0.7253379821777344
  Mean value: -6.018838405609131

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -31.92961883544922
  Max value: 17.00652503967285
  Mean value: 1.8643007278442383

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.957923889160156
  Max value: 15.481600761413574
  Mean value: 1.624603271484375

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.157659530639648
  Max value: 9.844192504882812
  Mean value: 1.3767597675323486

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.5278329849243164
  Max value: 1.7680639028549194
  Mean value: -0.3827230930328369

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([202, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.822443008422852
  Max value: 11.98373031616211
  Mean value: 0.53654545545578

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.867977142333984
  Max value: -10.976715087890625
  Mean value: -19.728036880493164
Total examples processed: 2432

Processing batch 20
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([191, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.846338272094727
  Max value: 9.64303970336914
  Mean value: 0.9075008034706116

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.709421157836914
  Max value: 7.396083831787109
  Mean value: 0.706242024898529

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.032991409301758
  Max value: 7.2114152908325195
  Mean value: 0.9351752996444702

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.461034774780273
  Max value: 8.841667175292969
  Mean value: -0.03747926279902458

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.157976150512695
  Max value: 10.772987365722656
  Mean value: -0.011654948815703392

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.59632110595703
  Max value: 8.102903366088867
  Mean value: 0.7907747030258179

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.824894428253174
  Max value: 8.263940811157227
  Mean value: -0.1411089152097702

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.717967987060547
  Max value: 10.738075256347656
  Mean value: 1.820744276046753

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.450056076049805
  Max value: 14.324902534484863
  Mean value: 1.8459986448287964

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.980426788330078
  Max value: 15.309566497802734
  Mean value: 2.138749837875366

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.178476333618164
  Max value: 15.82081413269043
  Mean value: -0.0320439450442791

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.95533561706543
  Max value: 14.042844772338867
  Mean value: -0.753795862197876

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -33.39466857910156
  Max value: 36.892852783203125
  Mean value: 0.034972090274095535

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -39.648094177246094
  Max value: 45.20446014404297
  Mean value: 3.068415880203247

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.875259399414062
  Max value: 15.447771072387695
  Mean value: 1.5261237621307373

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5101, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.91683578491211
  Max value: 8.16456127166748
  Mean value: -9.133712768554688

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([46, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.35297966003418
  Max value: 1.4361178874969482
  Mean value: -9.870996475219727

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -0.178105890750885
  Max value: 16.116865158081055
  Mean value: 9.350080490112305

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 0.8075267672538757
  Max value: 11.043627738952637
  Mean value: 6.215535640716553

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.7837246656417847
  Max value: 23.330108642578125
  Mean value: 8.396621704101562

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.599947929382324
  Max value: 4.924633979797363
  Mean value: 0.431357741355896

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 2.1586639881134033
  Max value: 8.906272888183594
  Mean value: 4.818179607391357

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([864, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.321917533874512
  Max value: 8.573684692382812
  Mean value: -1.2930433750152588

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.950600624084473
  Max value: 12.439924240112305
  Mean value: 1.3303749561309814

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.5376231670379639
  Max value: 10.077248573303223
  Mean value: 0.5995453596115112

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.4644341468811035
  Max value: 7.669004440307617
  Mean value: 1.9757405519485474

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.480409622192383
  Max value: 20.21402359008789
  Mean value: 2.226259708404541

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -30.3011474609375
  Max value: 18.607135772705078
  Mean value: 2.139867067337036

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.467957496643066
  Max value: 9.112810134887695
  Mean value: 1.478366494178772

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.368821144104004
  Max value: 3.53996205329895
  Mean value: -0.08901725709438324

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([171, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.231484413146973
  Max value: 11.099254608154297
  Mean value: 0.6312391757965088

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.011491775512695
  Max value: 1.477007508277893
  Mean value: -11.584609031677246
Total examples processed: 2560

Processing batch 21
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([165, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.802101135253906
  Max value: 10.239233016967773
  Mean value: 1.0575129985809326

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.72121810913086
  Max value: 27.868511199951172
  Mean value: -0.1357421725988388

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.150182723999023
  Max value: 28.93990707397461
  Mean value: 0.2596355676651001

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.628904342651367
  Max value: 28.06527328491211
  Mean value: 1.8426746129989624

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.361835479736328
  Max value: 27.845626831054688
  Mean value: 0.26085880398750305

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.25587272644043
  Max value: 29.259191513061523
  Mean value: 0.3471387028694153

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.303105354309082
  Max value: 6.3166351318359375
  Mean value: -0.142975851893425

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.639516830444336
  Max value: 10.395000457763672
  Mean value: 1.5706998109817505

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.990340709686279
  Max value: 12.735732078552246
  Mean value: 2.285348415374756

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.015359878540039
  Max value: 14.815810203552246
  Mean value: 2.17333984375

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.724029541015625
  Max value: 22.434160232543945
  Mean value: -0.001253585796803236

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.416099548339844
  Max value: 7.263881206512451
  Mean value: -0.8070855140686035

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.212806701660156
  Max value: 37.483821868896484
  Mean value: -0.16903233528137207

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.62447166442871
  Max value: 46.259307861328125
  Mean value: 2.9716272354125977

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.141882419586182
  Max value: 14.06303596496582
  Mean value: 1.4376312494277954

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4946, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.3485164642334
  Max value: 8.587333679199219
  Mean value: -9.280076026916504

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([277, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.15488052368164
  Max value: 2.2028515338897705
  Mean value: -11.034259796142578

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.630303382873535
  Max value: 18.14987564086914
  Mean value: 8.241657257080078

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 0.25782328844070435
  Max value: 12.439092636108398
  Mean value: 4.865191459655762

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.986586570739746
  Max value: 10.484296798706055
  Mean value: 2.243455410003662

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.959826469421387
  Max value: 8.081220626831055
  Mean value: 0.7021323442459106

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.879784345626831
  Max value: 11.8258056640625
  Mean value: 4.068087577819824

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1036, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.9549665451049805
  Max value: 9.153863906860352
  Mean value: -1.3702945709228516

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.432950973510742
  Max value: 7.987382888793945
  Mean value: -3.2609012126922607

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.200885772705078
  Max value: 9.931967735290527
  Mean value: 0.15587913990020752

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.977635383605957
  Max value: 0.4649583101272583
  Mean value: -4.517611026763916

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.589736938476562
  Max value: 21.19892120361328
  Mean value: 2.400761127471924

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.449872970581055
  Max value: 19.428394317626953
  Mean value: 2.207427978515625

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.0424113273620605
  Max value: 8.107048034667969
  Mean value: 1.4572035074234009

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([35, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.092004299163818
  Max value: 5.159111022949219
  Mean value: -0.2801578938961029

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([226, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.030789852142334
  Max value: 12.60202693939209
  Mean value: 1.1677980422973633

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.295326232910156
  Max value: 5.53814172744751
  Mean value: -8.415129661560059
Total examples processed: 2688

Processing batch 22
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([214, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.500272750854492
  Max value: 10.652803421020508
  Mean value: 0.9479309916496277

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.463878631591797
  Max value: 21.175251007080078
  Mean value: -2.0095303058624268

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.311979293823242
  Max value: 20.369285583496094
  Mean value: -3.83782958984375

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.319414138793945
  Max value: 10.551687240600586
  Mean value: -3.202192783355713

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.244709014892578
  Max value: 21.222232818603516
  Mean value: -0.8780193328857422

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.228893280029297
  Max value: 21.844818115234375
  Mean value: -1.1331448554992676

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.716596603393555
  Max value: 8.732704162597656
  Mean value: -0.15982083976268768

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([90, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.878368377685547
  Max value: 8.10009479522705
  Mean value: 1.3466789722442627

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.79902458190918
  Max value: 11.202595710754395
  Mean value: 1.884024739265442

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([87, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.079670906066895
  Max value: 12.724801063537598
  Mean value: 1.7237281799316406

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.651132583618164
  Max value: 12.971529006958008
  Mean value: -0.0828556939959526

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.77438735961914
  Max value: 9.952677726745605
  Mean value: -0.8127713203430176

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -40.84574890136719
  Max value: 34.194156646728516
  Mean value: -0.6713434457778931

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -37.70881652832031
  Max value: 39.68458938598633
  Mean value: 2.8889822959899902

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([87, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.003022193908691
  Max value: 15.052412033081055
  Mean value: 1.276315450668335

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5474, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.702064514160156
  Max value: 15.978604316711426
  Mean value: -9.012741088867188

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([136, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.702701568603516
  Max value: 5.202782154083252
  Mean value: -10.170795440673828

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.176950454711914
  Max value: 17.716768264770508
  Mean value: 2.0259480476379395

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.174012184143066
  Max value: 9.26817512512207
  Mean value: 0.7937139272689819

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.940091133117676
  Max value: 14.414694786071777
  Mean value: 0.6465947031974792

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.479249954223633
  Max value: 6.360934257507324
  Mean value: -1.9604740142822266

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.693273544311523
  Max value: 10.135108947753906
  Mean value: 1.8496296405792236

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1202, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.31427001953125
  Max value: 8.317691802978516
  Mean value: -1.3128231763839722

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.82475471496582
  Max value: 6.798188209533691
  Mean value: -4.07873010635376

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.404542922973633
  Max value: 8.502750396728516
  Mean value: -0.2848380208015442

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.038651466369629
  Max value: 9.706525802612305
  Mean value: -2.537357807159424

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.401836395263672
  Max value: 18.62810707092285
  Mean value: 1.7149001359939575

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.937179565429688
  Max value: 21.15971565246582
  Mean value: 1.5761668682098389

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.930649757385254
  Max value: 8.523985862731934
  Mean value: 1.404237985610962

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([9, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.689558267593384
  Max value: 4.722538948059082
  Mean value: 0.2207259237766266

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.9073398113250732
  Max value: 11.868558883666992
  Mean value: 0.857270359992981

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.73854637145996
  Max value: -9.93513298034668
  Mean value: -18.30259895324707
Total examples processed: 2816

Processing batch 23
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([183, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.593267440795898
  Max value: 11.635701179504395
  Mean value: 0.9606389403343201

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.074626922607422
  Max value: 31.26919174194336
  Mean value: 5.593539237976074

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.403392791748047
  Max value: 32.09161376953125
  Mean value: 5.401520729064941

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.992186546325684
  Max value: 26.047889709472656
  Mean value: 3.3188087940216064

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.605714797973633
  Max value: 29.010650634765625
  Mean value: 3.7373952865600586

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.528942108154297
  Max value: 26.789487838745117
  Mean value: 3.4989099502563477

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.005253791809082
  Max value: 7.299034595489502
  Mean value: -0.18151935935020447

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.352500915527344
  Max value: 10.878214836120605
  Mean value: 1.7107384204864502

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.05388069152832
  Max value: 13.5770902633667
  Mean value: 1.9627739191055298

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.530762672424316
  Max value: 13.587212562561035
  Mean value: 2.080343246459961

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.67427635192871
  Max value: 12.367648124694824
  Mean value: -0.037944648414850235

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.51502227783203
  Max value: 7.854586124420166
  Mean value: -0.7945286631584167

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.94133758544922
  Max value: 32.469337463378906
  Mean value: 0.13188399374485016

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.47531509399414
  Max value: 32.452613830566406
  Mean value: 2.0117788314819336

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.452643394470215
  Max value: 22.10626983642578
  Mean value: 1.4985129833221436

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5216, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.5975341796875
  Max value: 9.497464179992676
  Mean value: -9.045434951782227

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([29, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.854734420776367
  Max value: 2.734358310699463
  Mean value: -8.7979736328125

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.42535400390625
  Max value: 16.740543365478516
  Mean value: 11.551831245422363

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 3.6024322509765625
  Max value: 20.290706634521484
  Mean value: 7.04974365234375

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.554075717926025
  Max value: 7.084723949432373
  Mean value: -0.33013981580734253

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.446971416473389
  Max value: 3.4503231048583984
  Mean value: -1.0955262184143066

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 6.143505096435547
  Max value: 15.282421112060547
  Mean value: 9.021126747131348

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1164, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.625688552856445
  Max value: 8.451881408691406
  Mean value: -1.3279671669006348

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.0061378479003906
  Max value: 8.752612113952637
  Mean value: 0.8925415277481079

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.271303176879883
  Max value: 0.17237091064453125
  Mean value: -3.781121015548706

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -32.72418975830078
  Max value: 23.914243698120117
  Mean value: 2.4245107173919678

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.993927001953125
  Max value: 19.197179794311523
  Mean value: 1.931413173675537

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.505071640014648
  Max value: 11.209391593933105
  Mean value: 1.3822513818740845

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([54, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.437161445617676
  Max value: 16.6710205078125
  Mean value: 4.970836639404297

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([134, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.269317388534546
  Max value: 12.682463645935059
  Mean value: 1.054004430770874

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.390960693359375
  Max value: 8.452991485595703
  Mean value: -14.590166091918945
Total examples processed: 2944

Processing batch 24
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([178, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.679606914520264
  Max value: 14.691912651062012
  Mean value: 0.8668686747550964

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.78818702697754
  Max value: -0.702082633972168
  Mean value: -5.344615936279297

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.113492965698242
  Max value: 0.0534825325012207
  Mean value: -5.411777973175049

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.615432739257812
  Max value: -0.7687427997589111
  Mean value: -5.428677558898926

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.376174926757812
  Max value: 0.028394341468811035
  Mean value: -5.286282539367676

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.8035173416137695
  Max value: 6.7878875732421875
  Mean value: -0.1804535686969757

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.347614288330078
  Max value: 12.02467155456543
  Mean value: 1.702959656715393

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.901771545410156
  Max value: 12.26988697052002
  Mean value: 1.9746754169464111

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.989583015441895
  Max value: 11.563885688781738
  Mean value: 1.9388271570205688

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.393465995788574
  Max value: 8.50037956237793
  Mean value: -0.02367991954088211

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.127004623413086
  Max value: 6.644783973693848
  Mean value: -0.7524036765098572

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.25615119934082
  Max value: 44.62818908691406
  Mean value: 0.5731668472290039

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -39.351585388183594
  Max value: 53.792388916015625
  Mean value: 2.8963825702667236

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.653679847717285
  Max value: 15.834794998168945
  Mean value: 1.3276640176773071

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5596, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.60015296936035
  Max value: 19.265413284301758
  Mean value: -8.995953559875488

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([42, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.659271240234375
  Max value: -0.11293768882751465
  Mean value: -9.140752792358398

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.003608703613281
  Max value: -0.5150966644287109
  Mean value: -2.81276273727417

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.559774398803711
  Max value: -0.23472356796264648
  Mean value: -3.1548073291778564

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.925222396850586
  Max value: 0.31477904319763184
  Mean value: -4.668025016784668

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.367522716522217
  Max value: 1.1650190353393555
  Mean value: -3.289665699005127

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.4056379795074463
  Max value: 2.0844736099243164
  Mean value: -0.4205170273780823

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1011, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.579620361328125
  Max value: 7.352917671203613
  Mean value: -1.369033694267273

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.9075539112091064
  Max value: 2.672497272491455
  Mean value: -1.1974871158599854

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.272136688232422
  Max value: 20.817161560058594
  Mean value: 2.3052151203155518

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.200664520263672
  Max value: 25.67225456237793
  Mean value: 2.1240499019622803

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.640445709228516
  Max value: 11.48052978515625
  Mean value: 1.302857756614685

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([9, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.1430110931396484
  Max value: 4.979104995727539
  Mean value: 0.210110142827034

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([140, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.103902816772461
  Max value: 11.548604011535645
  Mean value: 0.7538686394691467

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.68710708618164
  Max value: -10.900064468383789
  Mean value: -19.533199310302734
Total examples processed: 3072

Processing batch 25
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([211, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.399394035339355
  Max value: 11.17563247680664
  Mean value: 0.9908074736595154

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.992067337036133
  Max value: 19.64620018005371
  Mean value: -0.5768133401870728

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.87362003326416
  Max value: 20.741065979003906
  Mean value: -0.682502269744873

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.374477863311768
  Max value: 8.193254470825195
  Mean value: -0.14497317373752594

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.63575267791748
  Max value: 11.74366283416748
  Mean value: 1.8064388036727905

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.025141716003418
  Max value: 15.504179000854492
  Mean value: 2.1727311611175537

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.911375999450684
  Max value: 16.43730926513672
  Mean value: 2.259824514389038

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.186336517333984
  Max value: 18.88046646118164
  Mean value: 0.03046906366944313

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.75535774230957
  Max value: 14.512242317199707
  Mean value: -0.7293793559074402

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.719886779785156
  Max value: 54.3997802734375
  Mean value: 0.16281166672706604

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.466358184814453
  Max value: 66.26029968261719
  Mean value: 2.913883924484253

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.586134910583496
  Max value: 15.662891387939453
  Mean value: 1.4727939367294312

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4989, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.764795303344727
  Max value: 8.829333305358887
  Mean value: -9.023319244384766

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([28, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.44615364074707
  Max value: 3.443107843399048
  Mean value: -9.538664817810059

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.40934944152832
  Max value: 14.233771324157715
  Mean value: 9.831182479858398

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.4298014640808105
  Max value: 6.369513511657715
  Mean value: 2.0581114292144775

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.285009860992432
  Max value: 2.8111658096313477
  Mean value: -1.1944222450256348

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1202, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.051271438598633
  Max value: 11.97933292388916
  Mean value: -1.2459781169891357

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.05508804321289
  Max value: -2.7787322998046875
  Mean value: -7.447741508483887

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -0.02643442153930664
  Max value: 12.02386474609375
  Mean value: 2.1475954055786133

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.861186027526855
  Max value: -0.973456859588623
  Mean value: -4.540806770324707

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.060279846191406
  Max value: 37.13149642944336
  Mean value: 2.5009961128234863

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.747421264648438
  Max value: 21.178531646728516
  Mean value: 2.135009288787842

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.106451034545898
  Max value: 10.13474178314209
  Mean value: 1.549841046333313

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([32, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.7680344581604
  Max value: 5.596087455749512
  Mean value: 0.0396212637424469

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([144, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.4061970710754395
  Max value: 10.039839744567871
  Mean value: 0.698971688747406

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.209732055664062
  Max value: -5.215687274932861
  Mean value: -17.147817611694336
Total examples processed: 3200

Processing batch 26
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([199, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.299170970916748
  Max value: 11.776050567626953
  Mean value: 1.0863903760910034

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.621938705444336
  Max value: 19.827932357788086
  Mean value: -2.4572086334228516

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.133955001831055
  Max value: 19.16785430908203
  Mean value: -2.397587776184082

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.205175399780273
  Max value: 20.047407150268555
  Mean value: 0.24541465938091278

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.528850555419922
  Max value: 24.156105041503906
  Mean value: -2.488133430480957

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.473400115966797
  Max value: 21.03512954711914
  Mean value: 0.7736729979515076

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.656017303466797
  Max value: 8.394597053527832
  Mean value: -0.14019253849983215

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([69, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.389389038085938
  Max value: 10.904718399047852
  Mean value: 1.4709153175354004

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.451390266418457
  Max value: 13.368700981140137
  Mean value: 1.95453941822052

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.865398406982422
  Max value: 14.123628616333008
  Mean value: 1.9394962787628174

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.440210342407227
  Max value: 16.60273551940918
  Mean value: 0.07110688835382462

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([69, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.904325485229492
  Max value: 14.052124977111816
  Mean value: -0.7396994829177856

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.818904876708984
  Max value: 30.41443634033203
  Mean value: 8.33840822451748e-05

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.671649932861328
  Max value: 43.492374420166016
  Mean value: 3.2458431720733643

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.740323066711426
  Max value: 19.69749641418457
  Mean value: 1.1971447467803955

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4785, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.088621139526367
  Max value: 13.644157409667969
  Mean value: -9.46335506439209

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([174, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.605398178100586
  Max value: 0.9520869255065918
  Mean value: -11.819229125976562

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.28686237335205
  Max value: 16.114030838012695
  Mean value: 5.3415398597717285

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.3817219734191895
  Max value: 11.882898330688477
  Mean value: 2.812629461288452

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.203387260437012
  Max value: 5.37770938873291
  Mean value: -3.3458900451660156

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.9006428718566895
  Max value: 5.302495956420898
  Mean value: 0.5998061895370483

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.220306396484375
  Max value: 11.834493637084961
  Mean value: 3.5931644439697266

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1100, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.42104434967041
  Max value: 8.987540245056152
  Mean value: -1.262769341468811

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.304956436157227
  Max value: 6.372436046600342
  Mean value: -4.1757917404174805

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.294552803039551
  Max value: 11.766511917114258
  Mean value: -0.16929036378860474

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.913310050964355
  Max value: 5.842445373535156
  Mean value: -4.572484970092773

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([68, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.885604858398438
  Max value: 17.987504959106445
  Mean value: 2.3160531520843506

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.079113006591797
  Max value: 22.07848358154297
  Mean value: 1.940641164779663

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.77879810333252
  Max value: 10.985702514648438
  Mean value: 1.459359884262085

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([67, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.775348663330078
  Max value: 9.22539234161377
  Mean value: 1.7059075832366943

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([87, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.0812249183654785
  Max value: 8.162233352661133
  Mean value: 0.3888210356235504

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.534597396850586
  Max value: 4.833165168762207
  Mean value: -15.306965827941895
Total examples processed: 3328

Processing batch 27
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([176, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.051750183105469
  Max value: 11.189510345458984
  Mean value: 1.035798192024231

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([8, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.578725814819336
  Max value: 21.55467414855957
  Mean value: 0.4271869659423828

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.21006965637207
  Max value: 22.896806716918945
  Mean value: -0.5419414043426514

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.800397872924805
  Max value: 21.52827262878418
  Mean value: 2.2192983627319336

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.47306251525879
  Max value: 25.6855525970459
  Mean value: 1.3441522121429443

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.326087951660156
  Max value: 24.43662452697754
  Mean value: 0.4787601828575134

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([68, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.702847957611084
  Max value: 8.035097122192383
  Mean value: -0.17518731951713562

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([61, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.836349487304688
  Max value: 9.390313148498535
  Mean value: 1.070725679397583

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.229735374450684
  Max value: 13.623296737670898
  Mean value: 1.8868616819381714

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.244768142700195
  Max value: 14.000983238220215
  Mean value: 1.8412319421768188

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.820772171020508
  Max value: 9.120803833007812
  Mean value: -0.014574063941836357

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.755718231201172
  Max value: 6.491698741912842
  Mean value: -0.7476621270179749

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.811067581176758
  Max value: 25.786705017089844
  Mean value: -0.9639876484870911

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -34.97760009765625
  Max value: 39.243804931640625
  Mean value: 2.2202770709991455

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([69, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.730862617492676
  Max value: 18.67201805114746
  Mean value: 1.3533713817596436

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5368, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.462596893310547
  Max value: 11.315164566040039
  Mean value: -9.350354194641113

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([177, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.340028762817383
  Max value: 2.7807703018188477
  Mean value: -8.621708869934082

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.544859409332275
  Max value: 20.620176315307617
  Mean value: 11.155476570129395

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([8, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.6391167640686035
  Max value: 14.288002967834473
  Mean value: 3.82550048828125

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.265277862548828
  Max value: 13.609651565551758
  Mean value: 2.596188545227051

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.4329962730407715
  Max value: 10.295944213867188
  Mean value: 0.760549008846283

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -0.8768388032913208
  Max value: 12.068682670593262
  Mean value: 4.51077938079834

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([807, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.961645126342773
  Max value: 8.082343101501465
  Mean value: -1.1529502868652344

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.775888442993164
  Max value: 12.464974403381348
  Mean value: -2.456479549407959

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([8, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.4212794303894043
  Max value: 10.625974655151367
  Mean value: 1.282765507698059

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([8, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.712041854858398
  Max value: 9.212596893310547
  Mean value: -0.7353066205978394

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([65, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -30.32415199279785
  Max value: 15.381773948669434
  Mean value: 1.5752545595169067

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.601396560668945
  Max value: 23.652233123779297
  Mean value: 1.1957823038101196

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.611717224121094
  Max value: 9.286705017089844
  Mean value: 1.117981195449829

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([103, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.7950520515441895
  Max value: 10.20530891418457
  Mean value: 1.4997071027755737

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([250, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.407027244567871
  Max value: 11.715616226196289
  Mean value: 0.6728406548500061

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.189796447753906
  Max value: -1.7242538928985596
  Mean value: -14.99918270111084
Total examples processed: 3456

Processing batch 28
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([236, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.958077907562256
  Max value: 11.319522857666016
  Mean value: 1.0140434503555298

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.086069107055664
  Max value: 15.726066589355469
  Mean value: -2.3710269927978516

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.404769897460938
  Max value: 17.146032333374023
  Mean value: -2.478745460510254

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.069665908813477
  Max value: 16.242839813232422
  Mean value: -1.3483586311340332

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.355724334716797
  Max value: 18.536643981933594
  Mean value: -1.0284820795059204

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.305709838867188
  Max value: 18.824098587036133
  Mean value: -1.0771154165267944

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.3280134201049805
  Max value: 9.042536735534668
  Mean value: -0.14346346259117126

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.810556411743164
  Max value: 9.305657386779785
  Mean value: 1.6504623889923096

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.82781982421875
  Max value: 11.200465202331543
  Mean value: 2.0628292560577393

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.886564254760742
  Max value: 10.951944351196289
  Mean value: 2.174746036529541

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.947761535644531
  Max value: 8.580892562866211
  Mean value: -0.03915289044380188

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.14877700805664
  Max value: 6.890636444091797
  Mean value: -0.75578373670578

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([87, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.53851890563965
  Max value: 33.30067825317383
  Mean value: -0.12227247655391693

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -30.764362335205078
  Max value: 46.65333938598633
  Mean value: 2.455008029937744

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.887935638427734
  Max value: 13.531896591186523
  Mean value: 1.5456595420837402

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5080, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.705738067626953
  Max value: 14.1329345703125
  Mean value: -9.404245376586914

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([236, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.826913833618164
  Max value: 1.5052107572555542
  Mean value: -11.2965726852417

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.247584342956543
  Max value: 18.081947326660156
  Mean value: 9.932097434997559

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.468621253967285
  Max value: 12.73739242553711
  Mean value: 3.119398355484009

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.132210731506348
  Max value: 6.055836200714111
  Mean value: -1.9071929454803467

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.542112827301025
  Max value: 5.610657215118408
  Mean value: 0.02851080894470215

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.9127912521362305
  Max value: 13.44824504852295
  Mean value: 2.858921527862549

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1108, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.578327178955078
  Max value: 7.945289611816406
  Mean value: -1.2726161479949951

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.348981857299805
  Max value: 6.763314247131348
  Mean value: -2.398390293121338

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.273484230041504
  Max value: 6.639102458953857
  Mean value: 0.43445834517478943

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.961162567138672
  Max value: 2.6164767742156982
  Mean value: -2.921466112136841

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.180187225341797
  Max value: 31.997840881347656
  Mean value: 2.4645063877105713

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.734270095825195
  Max value: 22.698640823364258
  Mean value: 1.9220985174179077

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.939210891723633
  Max value: 8.884844779968262
  Mean value: 1.516974687576294

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([331, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.86714506149292
  Max value: 12.123620986938477
  Mean value: 1.0695265531539917

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.29582977294922
  Max value: 5.880354881286621
  Mean value: -11.894901275634766
Total examples processed: 3584

Processing batch 29
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([123, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.650310039520264
  Max value: 9.803386688232422
  Mean value: 0.9263852834701538

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.898616790771484
  Max value: 26.554594039916992
  Mean value: 0.12191635370254517

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.06462287902832
  Max value: 27.83608627319336
  Mean value: -0.5827105045318604

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.012879371643066
  Max value: 27.50611686706543
  Mean value: 0.7149141430854797

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.588762283325195
  Max value: 30.888309478759766
  Mean value: 0.010914778336882591

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.372262954711914
  Max value: 28.030149459838867
  Mean value: 0.556576132774353

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.999939441680908
  Max value: 8.038776397705078
  Mean value: -0.10989370197057724

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([69, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.066161155700684
  Max value: 10.564678192138672
  Mean value: 1.8133349418640137

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.51038932800293
  Max value: 15.120552062988281
  Mean value: 2.233386993408203

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.2542524337768555
  Max value: 14.046098709106445
  Mean value: 2.3039393424987793

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([63, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.710554122924805
  Max value: 15.084071159362793
  Mean value: 0.05852867290377617

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.99690818786621
  Max value: 11.909222602844238
  Mean value: -0.8341878056526184

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.61225700378418
  Max value: 32.757442474365234
  Mean value: 0.008445311337709427

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([67, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -38.383544921875
  Max value: 62.669639587402344
  Mean value: 2.4795234203338623

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([66, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.9770894050598145
  Max value: 22.52532386779785
  Mean value: 1.3626258373260498

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4697, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.690126419067383
  Max value: 7.9865522384643555
  Mean value: -9.111861228942871

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([185, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.831012725830078
  Max value: 6.973233222961426
  Mean value: -7.600090503692627

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.110973358154297
  Max value: 22.55103874206543
  Mean value: 12.326010704040527

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.32227897644043
  Max value: 16.7972354888916
  Mean value: 4.217113971710205

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.9668970108032227
  Max value: 9.742430686950684
  Mean value: 2.1076831817626953

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.575941562652588
  Max value: 6.396340847015381
  Mean value: -0.09571988135576248

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 1.4538030624389648
  Max value: 13.556171417236328
  Mean value: 6.298253059387207

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([773, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.26507568359375
  Max value: 11.363649368286133
  Mean value: -1.2952346801757812

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.19864273071289
  Max value: 5.20503044128418
  Mean value: -3.0858895778656006

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.4707064628601074
  Max value: 13.312326431274414
  Mean value: 0.5040550231933594

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.787174224853516
  Max value: 8.135293960571289
  Mean value: -1.1766993999481201

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.86290740966797
  Max value: 23.627460479736328
  Mean value: 2.4301812648773193

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([68, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.263704299926758
  Max value: 15.03834342956543
  Mean value: 1.9029895067214966

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([59, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.33177375793457
  Max value: 10.151819229125977
  Mean value: 1.462960958480835

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([53, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.614310264587402
  Max value: 8.314656257629395
  Mean value: -0.14947231113910675

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([184, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.40529203414917
  Max value: 11.086832046508789
  Mean value: 0.6712531447410583

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.58137321472168
  Max value: 0.045397281646728516
  Mean value: -17.343441009521484
Total examples processed: 3712

Processing batch 30
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([176, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.874557971954346
  Max value: 13.672030448913574
  Mean value: 0.9992712736129761

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.283654689788818
  Max value: 16.70454978942871
  Mean value: 6.596525192260742

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.955035209655762
  Max value: 16.18069839477539
  Mean value: 6.333952903747559

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.57493257522583
  Max value: 15.388667106628418
  Mean value: 6.594768524169922

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.277248859405518
  Max value: 15.369937896728516
  Mean value: 6.572206497192383

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.18944787979126
  Max value: 6.8980326652526855
  Mean value: -0.14304475486278534

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.213783264160156
  Max value: 9.45057201385498
  Mean value: 1.1916464567184448

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.393920421600342
  Max value: 11.894619941711426
  Mean value: 1.9468107223510742

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([92, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.617118835449219
  Max value: 13.319375038146973
  Mean value: 1.7666031122207642

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.369884490966797
  Max value: 15.871404647827148
  Mean value: -0.07965514063835144

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.829444885253906
  Max value: 14.430999755859375
  Mean value: -0.8231027722358704

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([89, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.001537322998047
  Max value: 29.090591430664062
  Mean value: -0.29361575841903687

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.845901489257812
  Max value: 33.36665344238281
  Mean value: 2.082653284072876

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.399260997772217
  Max value: 16.944433212280273
  Mean value: 1.2286934852600098

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4899, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.94189453125
  Max value: 13.590518951416016
  Mean value: -9.218366622924805

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.224345207214355
  Max value: 0.6181284785270691
  Mean value: -5.513281345367432

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 4.608781814575195
  Max value: 13.279641151428223
  Mean value: 8.026524543762207

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 6.83945369720459
  Max value: 18.506099700927734
  Mean value: 12.530108451843262

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 7.310214042663574
  Max value: 11.822334289550781
  Mean value: 9.299233436584473

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1093, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.581949234008789
  Max value: 7.635670185089111
  Mean value: -1.2695050239562988

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([97, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.54701805114746
  Max value: 22.018898010253906
  Mean value: 1.8966755867004395

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.685253143310547
  Max value: 17.980995178222656
  Mean value: 1.8628062009811401

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.03951644897461
  Max value: 9.831453323364258
  Mean value: 1.3154430389404297

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([26, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.046579360961914
  Max value: 7.322574615478516
  Mean value: 0.2087787240743637

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([125, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.937643051147461
  Max value: 11.061551094055176
  Mean value: 0.5742849111557007

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.555469512939453
  Max value: -0.9368267059326172
  Mean value: -13.750179290771484
Total examples processed: 3840

Processing batch 31
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([155, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.929110527038574
  Max value: 11.049417495727539
  Mean value: 0.9336923956871033

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.43373680114746
  Max value: 0.06417202949523926
  Mean value: -3.8911237716674805

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.802061080932617
  Max value: 7.658125400543213
  Mean value: -1.9919335842132568

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.571128845214844
  Max value: 7.836325168609619
  Mean value: -2.045048475265503

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.15355110168457
  Max value: 8.07209300994873
  Mean value: -3.5252387523651123

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.43088150024414
  Max value: 7.9478535652160645
  Mean value: -1.9519495964050293

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.690664768218994
  Max value: 8.713974952697754
  Mean value: -0.09393737465143204

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.811766624450684
  Max value: 18.447479248046875
  Mean value: 1.8570605516433716

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.074461460113525
  Max value: 13.05741024017334
  Mean value: 2.0861034393310547

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([87, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.169219970703125
  Max value: 18.17462158203125
  Mean value: 2.374640703201294

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.909147262573242
  Max value: 11.941513061523438
  Mean value: 0.07311243563890457

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([69, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.832181930541992
  Max value: 8.285497665405273
  Mean value: -0.7859812378883362

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.28185272216797
  Max value: 44.02527618408203
  Mean value: 0.8121935725212097

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.802860260009766
  Max value: 54.90766525268555
  Mean value: 3.286519765853882

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.705880165100098
  Max value: 15.298566818237305
  Mean value: 1.4433434009552002

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5529, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.58470344543457
  Max value: 4.677949905395508
  Mean value: -9.056281089782715

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([319, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.068361282348633
  Max value: 0.7257499098777771
  Mean value: -11.052660942077637

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.366962432861328
  Max value: 8.759757041931152
  Mean value: -1.4524998664855957

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 0.3027251958847046
  Max value: 7.184004783630371
  Mean value: 3.4738070964813232

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.157529830932617
  Max value: 12.015429496765137
  Mean value: 0.7358969449996948

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.682151794433594
  Max value: 4.058067798614502
  Mean value: -2.0173466205596924

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 1.47196626663208
  Max value: 7.2413330078125
  Mean value: 3.848287343978882

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1289, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.541522026062012
  Max value: 7.104765892028809
  Mean value: -1.3250497579574585

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.750866413116455
  Max value: 0.7252206802368164
  Mean value: -1.857539176940918

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.089089393615723
  Max value: 1.609203815460205
  Mean value: -1.742012858390808

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.708518028259277
  Max value: 1.7173852920532227
  Mean value: -3.40261173248291

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.833744049072266
  Max value: 36.151123046875
  Mean value: 2.837120532989502

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.971644401550293
  Max value: 30.42549705505371
  Mean value: 2.528160572052002

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.484275817871094
  Max value: 10.382912635803223
  Mean value: 1.5703880786895752

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([24, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.7382636070251465
  Max value: 8.070094108581543
  Mean value: 0.5343056917190552

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([105, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.662797451019287
  Max value: 8.00107479095459
  Mean value: 0.3834618031978607

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.828107833862305
  Max value: -12.507392883300781
  Mean value: -20.842607498168945
Total examples processed: 3968

Processing batch 32
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([196, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.755035400390625
  Max value: 12.405928611755371
  Mean value: 0.9211466908454895

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.496864318847656
  Max value: 31.025455474853516
  Mean value: 0.6538177728652954

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.945920944213867
  Max value: 31.155839920043945
  Mean value: -0.4353210926055908

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.77239227294922
  Max value: 30.849458694458008
  Mean value: -1.9051204919815063

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.722217559814453
  Max value: 30.364160537719727
  Mean value: -1.7677814960479736

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.5542049407959
  Max value: 10.684179306030273
  Mean value: -3.1651535034179688

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.552426815032959
  Max value: 6.430604457855225
  Mean value: -0.14787277579307556

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.262590408325195
  Max value: 18.174959182739258
  Mean value: 1.976239562034607

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.577582359313965
  Max value: 14.561321258544922
  Mean value: 2.2290608882904053

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.826841354370117
  Max value: 19.662343978881836
  Mean value: 2.534539222717285

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.899273872375488
  Max value: 23.42473793029785
  Mean value: 0.10946009308099747

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([64, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.715591430664062
  Max value: 9.055061340332031
  Mean value: -0.8036983013153076

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.14948081970215
  Max value: 36.96631622314453
  Mean value: 0.995743453502655

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.773720741271973
  Max value: 44.17500686645508
  Mean value: 3.3445417881011963

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([68, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.94841480255127
  Max value: 19.614076614379883
  Mean value: 1.3714810609817505

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4318, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.909242630004883
  Max value: 23.170135498046875
  Mean value: -8.873534202575684

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([337, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.726972579956055
  Max value: 3.954174757003784
  Mean value: -11.286100387573242

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.920546531677246
  Max value: 19.542469024658203
  Mean value: 5.846500396728516

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.107282638549805
  Max value: 21.115720748901367
  Mean value: 2.9370646476745605

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.722443580627441
  Max value: 12.726144790649414
  Mean value: 0.9905519485473633

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.093634605407715
  Max value: 8.2574462890625
  Mean value: -0.6418809294700623

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.59472918510437
  Max value: 13.390717506408691
  Mean value: 4.707130432128906

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1189, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.8558349609375
  Max value: 7.19600772857666
  Mean value: -1.3612903356552124

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.185276985168457
  Max value: 13.151006698608398
  Mean value: -0.6856803297996521

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.203277111053467
  Max value: 5.641781806945801
  Mean value: -0.8161405324935913

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.369750022888184
  Max value: 9.100521087646484
  Mean value: -1.8644342422485352

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.10971450805664
  Max value: 24.000383377075195
  Mean value: 2.913283348083496

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.367937088012695
  Max value: 18.34950065612793
  Mean value: 2.3715052604675293

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.684632301330566
  Max value: 12.516419410705566
  Mean value: 1.6711300611495972

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([132, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.248627185821533
  Max value: 11.1866455078125
  Mean value: 1.3656415939331055

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([210, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.504835605621338
  Max value: 11.876850128173828
  Mean value: 0.3220127820968628

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([11, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.179929733276367
  Max value: 6.854274749755859
  Mean value: -17.49302864074707
Total examples processed: 4096

Processing batch 33
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([157, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.051939487457275
  Max value: 12.155080795288086
  Mean value: 1.0637164115905762

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.243724822998047
  Max value: 25.190128326416016
  Mean value: -2.2163562774658203

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.453166961669922
  Max value: 20.8237247467041
  Mean value: -2.7845399379730225

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.83885955810547
  Max value: 25.675065994262695
  Mean value: 0.085751473903656

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.579795837402344
  Max value: 30.200353622436523
  Mean value: 4.043974876403809

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.853103637695312
  Max value: 11.707722663879395
  Mean value: -4.846695899963379

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.612987995147705
  Max value: 10.643325805664062
  Mean value: -0.11321563273668289

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([65, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.814722061157227
  Max value: 13.618403434753418
  Mean value: 1.2799025774002075

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([69, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.480159282684326
  Max value: 12.762660026550293
  Mean value: 1.95713472366333

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.780484199523926
  Max value: 14.438307762145996
  Mean value: 1.9571242332458496

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.373479843139648
  Max value: 7.625145435333252
  Mean value: -0.08748495578765869

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.550509452819824
  Max value: 8.617846488952637
  Mean value: -0.8649049997329712

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -39.14167785644531
  Max value: 24.791738510131836
  Mean value: -0.6798410415649414

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -33.35301971435547
  Max value: 39.09745788574219
  Mean value: 1.495117425918579

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.438732147216797
  Max value: 16.201242446899414
  Mean value: 1.1742795705795288

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4828, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.47072410583496
  Max value: 10.830947875976562
  Mean value: -8.956993103027344

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([123, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.748279571533203
  Max value: 3.3040623664855957
  Mean value: -8.92269229888916

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.767462730407715
  Max value: 17.745832443237305
  Mean value: 13.03355598449707

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.5848042964935303
  Max value: 16.293975830078125
  Mean value: 1.4579007625579834

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.551389694213867
  Max value: 6.828823566436768
  Mean value: 0.7297382354736328

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.4864301681518555
  Max value: 8.209371566772461
  Mean value: 0.6883246898651123

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.0365147590637207
  Max value: 11.064860343933105
  Mean value: 3.682027578353882

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1207, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.475522994995117
  Max value: 8.873207092285156
  Mean value: -1.3636133670806885

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.3716983795166
  Max value: 0.13276433944702148
  Mean value: -5.627932071685791

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.022947311401367
  Max value: 13.195432662963867
  Mean value: 0.09836122393608093

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.639450073242188
  Max value: 5.382815361022949
  Mean value: -4.033336639404297

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.709257125854492
  Max value: 21.533611297607422
  Mean value: 2.043280601501465

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.06904411315918
  Max value: 18.52878761291504
  Mean value: 1.4327001571655273

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.113656044006348
  Max value: 8.097564697265625
  Mean value: 1.3895061016082764

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([31, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.0607500076293945
  Max value: 7.472345352172852
  Mean value: 0.8677684664726257

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([144, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.362453460693359
  Max value: 10.579968452453613
  Mean value: 0.6495365500450134

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.743350982666016
  Max value: 0.01136016845703125
  Mean value: -14.750057220458984
Total examples processed: 4224

Processing batch 34
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([169, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.292119979858398
  Max value: 11.392875671386719
  Mean value: 0.9932944178581238

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.66250991821289
  Max value: 24.462074279785156
  Mean value: -3.9234657287597656

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.021968841552734
  Max value: 28.922161102294922
  Mean value: -2.908726453781128

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.815401077270508
  Max value: 28.30038070678711
  Mean value: -0.28360715508461

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.003360748291016
  Max value: 28.47916603088379
  Mean value: -1.5533555746078491

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.231660842895508
  Max value: 25.555696487426758
  Mean value: -1.7837132215499878

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.654282093048096
  Max value: 9.227521896362305
  Mean value: -0.11169860512018204

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([69, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.890758514404297
  Max value: 17.081565856933594
  Mean value: 1.8748934268951416

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.030832290649414
  Max value: 12.392800331115723
  Mean value: 1.9634761810302734

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.41069507598877
  Max value: 14.076154708862305
  Mean value: 2.0409843921661377

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.2335205078125
  Max value: 11.110700607299805
  Mean value: -0.11692769080400467

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([69, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.706502914428711
  Max value: 8.370201110839844
  Mean value: -0.8225812911987305

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.9887752532959
  Max value: 40.415592193603516
  Mean value: -0.21987459063529968

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.152374267578125
  Max value: 36.26545715332031
  Mean value: 2.1146275997161865

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.277230262756348
  Max value: 13.462462425231934
  Mean value: 1.2931855916976929

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4849, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.362462997436523
  Max value: 15.099411010742188
  Mean value: -9.241419792175293

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([358, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.829111099243164
  Max value: 4.549366474151611
  Mean value: -10.278632164001465

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.968070983886719
  Max value: 20.585922241210938
  Mean value: 6.827404499053955

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.623785495758057
  Max value: 15.468592643737793
  Mean value: 2.963010549545288

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.737449645996094
  Max value: 23.524860382080078
  Mean value: 2.308098554611206

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.29986047744751
  Max value: 10.191360473632812
  Mean value: 0.09892239421606064

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.5176124572753906
  Max value: 12.62753677368164
  Mean value: 3.3740010261535645

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([934, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.948836326599121
  Max value: 10.661312103271484
  Mean value: -1.2314015626907349

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.809619903564453
  Max value: 8.41153335571289
  Mean value: -3.4562933444976807

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.366291999816895
  Max value: 10.399530410766602
  Mean value: -0.06779904663562775

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.209122657775879
  Max value: 16.40788459777832
  Mean value: 2.6236839294433594

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.969947814941406
  Max value: 31.32518768310547
  Mean value: 1.8917841911315918

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.05681037902832
  Max value: 23.539430618286133
  Mean value: 1.3878058195114136

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.421964645385742
  Max value: 8.811326026916504
  Mean value: 1.4293063879013062

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([280, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.540932655334473
  Max value: 11.042064666748047
  Mean value: 0.6441978216171265

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.778804779052734
  Max value: 1.0490150451660156
  Mean value: -11.618521690368652
Total examples processed: 4352

Processing batch 35
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([169, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.190587043762207
  Max value: 10.481745719909668
  Mean value: 0.9113370776176453

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.521434783935547
  Max value: 24.74897003173828
  Mean value: 3.5201470851898193

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.164806365966797
  Max value: 25.99289894104004
  Mean value: 3.2022571563720703

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.720910549163818
  Max value: 7.170116424560547
  Mean value: -0.10815078020095825

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([87, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.266353607177734
  Max value: 12.027742385864258
  Mean value: 1.397963285446167

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.072837829589844
  Max value: 13.595401763916016
  Mean value: 1.7057234048843384

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.668071746826172
  Max value: 13.93632698059082
  Mean value: 1.8786649703979492

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([89, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.957088470458984
  Max value: 11.702644348144531
  Mean value: -0.1378617137670517

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.261932373046875
  Max value: 7.754825592041016
  Mean value: -0.8717579245567322

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.85336685180664
  Max value: 35.80084991455078
  Mean value: -0.1948256492614746

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.612529754638672
  Max value: 46.08003616333008
  Mean value: 1.9369349479675293

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.652191162109375
  Max value: 15.639260292053223
  Mean value: 1.1544405221939087

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5275, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.95481300354004
  Max value: 16.217634201049805
  Mean value: -9.073941230773926

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([15, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.161564826965332
  Max value: 1.3455917835235596
  Mean value: -8.537798881530762

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.778191089630127
  Max value: 19.28542137145996
  Mean value: 14.59361457824707

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 4.873913764953613
  Max value: 13.029363632202148
  Mean value: 7.321272850036621

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([961, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.457615852355957
  Max value: 9.285558700561523
  Mean value: -1.285327434539795

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.759916305541992
  Max value: 0.293123722076416
  Mean value: -4.897873878479004

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -0.36854124069213867
  Max value: 8.646186828613281
  Mean value: 2.2186131477355957

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.509349822998047
  Max value: 28.649892807006836
  Mean value: 1.9542609453201294

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.00678825378418
  Max value: 19.43321990966797
  Mean value: 1.405502438545227

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.447819709777832
  Max value: 9.434992790222168
  Mean value: 1.4559985399246216

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([85, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.7664551734924316
  Max value: 8.001120567321777
  Mean value: 0.3264525532722473

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.25448226928711
  Max value: -10.686722755432129
  Mean value: -18.860544204711914
Total examples processed: 4480

Processing batch 36
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([205, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.287049770355225
  Max value: 10.627986907958984
  Mean value: 0.9162285923957825

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.41340446472168
  Max value: 8.32754898071289
  Mean value: -0.49085351824760437

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.969770431518555
  Max value: 23.09587860107422
  Mean value: 0.786313533782959

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([2, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.834689140319824
  Max value: 22.956722259521484
  Mean value: 2.6602888107299805

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.02382469177246
  Max value: 8.320317268371582
  Mean value: -0.6578493118286133

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.958274841308594
  Max value: 8.63747787475586
  Mean value: -0.681738555431366

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([90, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.434413909912109
  Max value: 6.298283100128174
  Mean value: -0.15283235907554626

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.280864715576172
  Max value: 11.590761184692383
  Mean value: 1.3443412780761719

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.933752059936523
  Max value: 15.68118667602539
  Mean value: 2.0573179721832275

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.04098892211914
  Max value: 12.613090515136719
  Mean value: 1.8125970363616943

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.206785202026367
  Max value: 17.74445343017578
  Mean value: -0.0637514665722847

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([87, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.367911338806152
  Max value: 21.075485229492188
  Mean value: -0.7806541323661804

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([90, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -30.11507797241211
  Max value: 35.430450439453125
  Mean value: -0.24868282675743103

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.691532135009766
  Max value: 45.67157745361328
  Mean value: 1.8834049701690674

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.36094856262207
  Max value: 18.647586822509766
  Mean value: 1.2423230409622192

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5074, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.91337013244629
  Max value: 9.426329612731934
  Mean value: -9.040465354919434

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([177, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.573293685913086
  Max value: 1.5672297477722168
  Mean value: -10.96298599243164

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.2169647216796875
  Max value: 18.286544799804688
  Mean value: 9.44155502319336

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -0.5532733798027039
  Max value: 14.828311920166016
  Mean value: 5.427155494689941

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.747791290283203
  Max value: 16.480077743530273
  Mean value: 5.615642547607422

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -2.772113800048828
  Max value: 4.31425666809082
  Mean value: 0.6298588514328003

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 0.10045188665390015
  Max value: 11.575286865234375
  Mean value: 4.6573286056518555

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1154, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.483194351196289
  Max value: 8.804632186889648
  Mean value: -1.275265097618103

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.973094940185547
  Max value: 7.896066665649414
  Mean value: -1.3476293087005615

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.218087673187256
  Max value: 7.079837799072266
  Mean value: 0.7065762877464294

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.992834568023682
  Max value: 8.722865104675293
  Mean value: 0.7338461875915527

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([84, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.990917205810547
  Max value: 23.325368881225586
  Mean value: 2.005821943283081

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([83, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.340715408325195
  Max value: 19.15227508544922
  Mean value: 1.4466028213500977

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.355400085449219
  Max value: 10.003371238708496
  Mean value: 1.3362637758255005

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.3766064643859863
  Max value: 0.621111273765564
  Mean value: -1.1358096599578857

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([128, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.255592346191406
  Max value: 11.228224754333496
  Mean value: 0.6325904130935669

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -27.44890785217285
  Max value: -3.0724973678588867
  Mean value: -10.530686378479004
Total examples processed: 4608

Processing batch 37
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([134, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.475815296173096
  Max value: 10.425869941711426
  Mean value: 0.97004234790802

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([9, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.55324935913086
  Max value: 27.278907775878906
  Mean value: 1.5511897802352905

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([8, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.942777633666992
  Max value: 22.780719757080078
  Mean value: 0.5017861127853394

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -22.195274353027344
  Max value: 26.084529876708984
  Mean value: 1.748308539390564

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.74150848388672
  Max value: 14.648249626159668
  Mean value: -1.6850134134292603

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.11212921142578
  Max value: 27.722333908081055
  Mean value: 0.3649318814277649

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([74, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.372584342956543
  Max value: 8.816210746765137
  Mean value: -0.09722785651683807

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.305316925048828
  Max value: 9.81252670288086
  Mean value: 1.7111729383468628

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.444876670837402
  Max value: 16.250469207763672
  Mean value: 2.0437638759613037

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.524340629577637
  Max value: 18.361812591552734
  Mean value: 2.358332872390747

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([75, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.448759078979492
  Max value: 13.135543823242188
  Mean value: -0.04291708394885063

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.85051727294922
  Max value: 13.353092193603516
  Mean value: -0.7457143068313599

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -33.2754020690918
  Max value: 23.596485137939453
  Mean value: -0.1338842809200287

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -36.615333557128906
  Max value: 35.443790435791016
  Mean value: 2.3574016094207764

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([71, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.393120765686035
  Max value: 18.665828704833984
  Mean value: 1.4989501237869263

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4624, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.88477325439453
  Max value: 10.092750549316406
  Mean value: -9.20279312133789

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([211, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.0577449798584
  Max value: 17.905736923217773
  Mean value: -8.615433692932129

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.968204498291016
  Max value: 22.247581481933594
  Mean value: 7.97010612487793

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([9, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -1.3953197002410889
  Max value: 22.891420364379883
  Mean value: 6.208098411560059

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.129060745239258
  Max value: 18.874223709106445
  Mean value: 2.1760075092315674

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([8, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.521391868591309
  Max value: 16.981861114501953
  Mean value: 1.6391023397445679

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([9, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.567209243774414
  Max value: 12.794118881225586
  Mean value: 4.3837456703186035

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1000, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.584680080413818
  Max value: 7.760970115661621
  Mean value: -1.3892556428909302

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([7, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.46746301651001
  Max value: 16.08188247680664
  Mean value: 0.9823548793792725

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([9, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.450572490692139
  Max value: 14.61082649230957
  Mean value: 0.9318872094154358

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([9, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -14.925596237182617
  Max value: 8.351034164428711
  Mean value: 0.6153691411018372

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -24.221542358398438
  Max value: 17.506725311279297
  Mean value: 2.3158249855041504

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.19072723388672
  Max value: 15.435121536254883
  Mean value: 2.175690174102783

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([70, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.911088943481445
  Max value: 10.54107666015625
  Mean value: 1.5437374114990234

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.267556667327881
  Max value: 10.38071346282959
  Mean value: 1.4864394664764404

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([156, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.6144561767578125
  Max value: 11.501092910766602
  Mean value: 0.8563212752342224

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([8, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.48046112060547
  Max value: 3.731374979019165
  Mean value: -14.362578392028809
Total examples processed: 4736

Processing batch 38
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([172, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.755887508392334
  Max value: 10.635068893432617
  Mean value: 0.9953234791755676

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.992280960083008
  Max value: 21.157262802124023
  Mean value: -0.9106340408325195

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.460538864135742
  Max value: 19.974214553833008
  Mean value: -2.6259360313415527

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.381610870361328
  Max value: 2.89158296585083
  Mean value: -4.92799711227417

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -20.350303649902344
  Max value: 20.29036521911621
  Mean value: -2.8178043365478516

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([3, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.624879837036133
  Max value: 2.9138600826263428
  Mean value: -4.822443008422852

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.7580132484436035
  Max value: 5.870327949523926
  Mean value: -0.17564910650253296

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.745462417602539
  Max value: 9.461341857910156
  Mean value: 1.420054316520691

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([87, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.085962295532227
  Max value: 13.88673210144043
  Mean value: 1.9446340799331665

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -10.746788024902344
  Max value: 12.585724830627441
  Mean value: 1.9102143049240112

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([89, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.603690147399902
  Max value: 18.60930633544922
  Mean value: -0.10786540061235428

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([86, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.722854614257812
  Max value: 15.927428245544434
  Mean value: -0.8182476162910461

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([81, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.274703979492188
  Max value: 38.13547134399414
  Mean value: -0.7021495699882507

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -29.20701789855957
  Max value: 39.06227111816406
  Mean value: 1.3545347452163696

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -7.4547576904296875
  Max value: 17.230438232421875
  Mean value: 1.1831403970718384

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4910, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -25.148311614990234
  Max value: 12.861929893493652
  Mean value: -9.07971477508545

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([347, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.638713836669922
  Max value: 3.4520533084869385
  Mean value: -9.950023651123047

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.698602676391602
  Max value: 19.354124069213867
  Mean value: 5.049890041351318

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.431698799133301
  Max value: 10.58169174194336
  Mean value: 2.0882723331451416

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.613565921783447
  Max value: 10.33734130859375
  Mean value: 1.3313831090927124

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.958712577819824
  Max value: 6.379249095916748
  Mean value: -1.7441110610961914

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.301100492477417
  Max value: 10.089092254638672
  Mean value: 2.1294779777526855

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1046, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.525818824768066
  Max value: 9.79783821105957
  Mean value: -1.3038547039031982

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -16.05807876586914
  Max value: 5.342403888702393
  Mean value: -3.9014720916748047

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.972968101501465
  Max value: 3.9524905681610107
  Mean value: -1.8123905658721924

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.67005729675293
  Max value: 5.533060073852539
  Mean value: -4.1295061111450195

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([80, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.461101531982422
  Max value: 21.215913772583008
  Mean value: 1.7917455434799194

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([78, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -18.301790237426758
  Max value: 18.08876609802246
  Mean value: 2.0103440284729004

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([79, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.611906051635742
  Max value: 8.679963111877441
  Mean value: 1.397991418838501

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([50, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.253373622894287
  Max value: 10.820435523986816
  Mean value: 2.6611642837524414

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([232, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -6.464757442474365
  Max value: 11.872785568237305
  Mean value: 0.5655493140220642

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([5, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -26.173015594482422
  Max value: 0.8436923027038574
  Mean value: -13.143688201904297
Total examples processed: 4864

Processing batch 39
Processing full batch of 128 examples
Data moved to device
Added catalog to input_dict with shape torch.Size([128, 102])
Added catalog to target_mask with shape torch.Size([128, 102])
Added tok_a_g to input_dict with shape torch.Size([128, 1])
Added tok_a_g to target_mask with shape torch.Size([128, 1])
Added tok_a_i to input_dict with shape torch.Size([128, 1])
Added tok_a_i to target_mask with shape torch.Size([128, 1])
Added tok_a_r to input_dict with shape torch.Size([128, 1])
Added tok_a_r to target_mask with shape torch.Size([128, 1])
Added tok_a_y to input_dict with shape torch.Size([128, 1])
Added tok_a_y to target_mask with shape torch.Size([128, 1])
Added tok_a_z to input_dict with shape torch.Size([128, 1])
Added tok_a_z to target_mask with shape torch.Size([128, 1])
Added tok_ebv to input_dict with shape torch.Size([128, 1])
Added tok_ebv to target_mask with shape torch.Size([128, 1])
Added tok_flux_g to input_dict with shape torch.Size([128, 1])
Added tok_flux_g to target_mask with shape torch.Size([128, 1])
Added tok_flux_i to input_dict with shape torch.Size([128, 1])
Added tok_flux_i to target_mask with shape torch.Size([128, 1])
Added tok_flux_r to input_dict with shape torch.Size([128, 1])
Added tok_flux_r to target_mask with shape torch.Size([128, 1])
Added tok_flux_w1 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w1 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w2 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w2 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w3 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w3 to target_mask with shape torch.Size([128, 1])
Added tok_flux_w4 to input_dict with shape torch.Size([128, 1])
Added tok_flux_w4 to target_mask with shape torch.Size([128, 1])
Added tok_flux_z to input_dict with shape torch.Size([128, 1])
Added tok_flux_z to target_mask with shape torch.Size([128, 1])
Added tok_image to input_dict with shape torch.Size([128, 576])
Added tok_image to target_mask with shape torch.Size([128, 576])
Added tok_image_hsc to input_dict with shape torch.Size([128, 576])
Added tok_image_hsc to target_mask with shape torch.Size([128, 576])
Added tok_mag_g to input_dict with shape torch.Size([128, 1])
Added tok_mag_g to target_mask with shape torch.Size([128, 1])
Added tok_mag_i to input_dict with shape torch.Size([128, 1])
Added tok_mag_i to target_mask with shape torch.Size([128, 1])
Added tok_mag_r to input_dict with shape torch.Size([128, 1])
Added tok_mag_r to target_mask with shape torch.Size([128, 1])
Added tok_mag_y to input_dict with shape torch.Size([128, 1])
Added tok_mag_y to target_mask with shape torch.Size([128, 1])
Added tok_mag_z to input_dict with shape torch.Size([128, 1])
Added tok_mag_z to target_mask with shape torch.Size([128, 1])
Added tok_segmap to input_dict with shape torch.Size([128, 144])
Added tok_segmap to target_mask with shape torch.Size([128, 144])
Added tok_shape11 to input_dict with shape torch.Size([128, 1])
Added tok_shape11 to target_mask with shape torch.Size([128, 1])
Added tok_shape12 to input_dict with shape torch.Size([128, 1])
Added tok_shape12 to target_mask with shape torch.Size([128, 1])
Added tok_shape22 to input_dict with shape torch.Size([128, 1])
Added tok_shape22 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e1 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e1 to target_mask with shape torch.Size([128, 1])
Added tok_shape_e2 to input_dict with shape torch.Size([128, 1])
Added tok_shape_e2 to target_mask with shape torch.Size([128, 1])
Added tok_shape_r to input_dict with shape torch.Size([128, 1])
Added tok_shape_r to target_mask with shape torch.Size([128, 1])
Added tok_spectrum_desi to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_desi to target_mask with shape torch.Size([128, 273])
Added tok_spectrum_sdss to input_dict with shape torch.Size([128, 273])
Added tok_spectrum_sdss to target_mask with shape torch.Size([128, 273])
Added tok_z to input_dict with shape torch.Size([128, 1])
Added tok_z to target_mask with shape torch.Size([128, 1])

Running forward pass...

Hook received output shape: torch.Size([128, 256, 768])

Model output dictionary contents:

Modality: catalog
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([240, 3468])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.79021692276001
  Max value: 11.078119277954102
  Mean value: 0.9804345369338989

Modality: tok_a_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_a_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.202159881591797
  Max value: 14.547277450561523
  Mean value: -2.32249116897583

Modality: tok_a_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.848784446716309
  Max value: 13.905712127685547
  Mean value: -2.285980701446533

Modality: tok_a_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -15.151187896728516
  Max value: 17.123661041259766
  Mean value: -1.9910579919815063

Modality: tok_a_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_ebv
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([69, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.611644744873047
  Max value: 6.109060287475586
  Mean value: -0.14229816198349

Modality: tok_flux_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([77, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -13.376919746398926
  Max value: 11.969301223754883
  Mean value: 1.644186019897461

Modality: tok_flux_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.421839714050293
  Max value: 14.87123966217041
  Mean value: 2.017727851867676

Modality: tok_flux_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([82, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.630882263183594
  Max value: 19.746488571166992
  Mean value: 2.1512269973754883

Modality: tok_flux_w1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -17.04431915283203
  Max value: 25.754053115844727
  Mean value: 0.05789133906364441

Modality: tok_flux_w2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -19.200891494750977
  Max value: 15.06930923461914
  Mean value: -0.7596639394760132

Modality: tok_flux_w3
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -36.08533477783203
  Max value: 40.752010345458984
  Mean value: 0.7330460548400879

Modality: tok_flux_w4
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -39.518577575683594
  Max value: 57.1550407409668
  Mean value: 3.2251720428466797

Modality: tok_flux_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([72, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -11.735530853271484
  Max value: 17.554550170898438
  Mean value: 1.4207721948623657

Modality: tok_image
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([4851, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -23.95836639404297
  Max value: 5.6148481369018555
  Mean value: -8.877259254455566

Modality: tok_image_hsc
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([38, 4375])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -21.615243911743164
  Max value: 2.2139711380004883
  Mean value: -11.643704414367676

Modality: tok_mag_g
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.67474365234375
  Max value: 13.386809349060059
  Mean value: 8.898155212402344

Modality: tok_mag_i
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_mag_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_mag_y
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -3.5134341716766357
  Max value: 3.9956259727478027
  Mean value: -0.3768739104270935

Modality: tok_mag_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 0.6369943618774414
  Max value: 8.362689018249512
  Mean value: 3.57878041267395

Modality: tok_segmap
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1191, 1000])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -8.29096794128418
  Max value: 6.723021030426025
  Mean value: -1.3664569854736328

Modality: tok_shape11
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([0, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Empty tensor - skipping min/max/mean calculations

Modality: tok_shape12
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: 0.469997763633728
  Max value: 10.246419906616211
  Mean value: 2.530132293701172

Modality: tok_shape22
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([1, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -9.856901168823242
  Max value: -0.5672938823699951
  Mean value: -4.235561370849609

Modality: tok_shape_e1
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([73, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -32.32605743408203
  Max value: 25.497100830078125
  Mean value: 2.14668607711792

Modality: tok_shape_e2
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -37.275177001953125
  Max value: 30.70446014404297
  Mean value: 2.1295113563537598

Modality: tok_shape_r
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([76, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -12.145245552062988
  Max value: 9.9638671875
  Mean value: 1.3733505010604858

Modality: tok_spectrum_desi
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([115, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -5.0187788009643555
  Max value: 14.758874893188477
  Mean value: 2.8134605884552

Modality: tok_spectrum_sdss
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([194, 1024])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -4.065431118011475
  Max value: 11.092090606689453
  Mean value: 0.5911548137664795

Modality: tok_z
  Output type: <class 'torch.Tensor'>
  Shape: torch.Size([6, 1025])
  Dtype: torch.float32
  Device: cuda:0
  Min value: -28.613405227661133
  Max value: 3.746751308441162
  Mean value: -16.53366470336914
Total examples processed: 4992

Hook removed

=== Modality Sample Counts ===
  catalog: 4992 samples
  tok_a_g: 4862 samples
  tok_a_i: 4860 samples
  tok_a_r: 4881 samples
  tok_a_y: 4869 samples
  tok_a_z: 4874 samples
  tok_ebv: 1966 samples
  tok_flux_g: 1965 samples
  tok_flux_i: 1947 samples
  tok_flux_r: 1910 samples
  tok_flux_w1: 1908 samples
  tok_flux_w2: 1962 samples
  tok_flux_w3: 1920 samples
  tok_flux_w4: 1961 samples
  tok_flux_z: 1979 samples
  tok_image: 4992 samples
  tok_image_hsc: 4992 samples
  tok_mag_g: 4869 samples
  tok_mag_i: 4858 samples
  tok_mag_r: 4874 samples
  tok_mag_y: 4874 samples
  tok_mag_z: 4869 samples
  tok_segmap: 4992 samples
  tok_shape11: 4878 samples
  tok_shape12: 4869 samples
  tok_shape22: 4870 samples
  tok_shape_e1: 1923 samples
  tok_shape_e2: 1936 samples
  tok_shape_r: 1981 samples
  tok_spectrum_desi: 4992 samples
  tok_spectrum_sdss: 4992 samples
  tok_z: 4813 samples
Total examples processed: 4992
Sum of all modality counts: 121430

Concatenating activations...
Final activations shape: torch.Size([4992, 256, 768])
Final activations dtype: torch.float32
Final activations device: cpu

Flattening activations...
Original activations shape: torch.Size([4992, 256, 768]) -> [sample_size, seq_length, embed_dim]
Flattened activations shape: torch.Size([1277952, 768]) -> [sample_size*seq_length, embed_dim]
Flattened activations dtype: torch.float32
Flattened activations device: cpu

=== Saving Activations ===
Saved 4992 examples of activations to /mnt/home/rzhang/ceph/activations_4992examples.pt
File size: 3744.00 MB
